import{_ as p}from"./ValaxyMain.vue_vue_type_style_index_0_lang-Bn109ln0.js";import{c,w as t,f as w,a as x,p as u,o as g,g as l,h as n,r as i}from"./app-DvGICojQ.js";import"./YunFooter.vue_vue_type_style_index_0_lang-6I6EwKPx.js";import"./YunCard.vue_vue_type_script_setup_true_lang-G2SLBOpE.js";import"./index-C5okkQwF.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang-B-GmT0Fn.js";import"./post-JeTKiWMk.js";const d="/assets/new-DFqi2RT4.png",k="/assets/assign-CsHXixyR.png",M="/assets/store-DeAYDmHL.png",y="/assets/load-Bee7jiG5.png",b="/assets/propagate-DHKWs5sV.png",f="/assets/pfg-edges-BaPV31iN.png",_="/assets/pfg-eg-C0aFUh9g.png",E="/assets/pta-intra-alg-eg-yTTGrvkJ.png",L="/assets/call-rule-QopUe021.png",P="/assets/reachable-DynG7RVO.png",v="/assets/pta-inter-alg-eg-DW1hCkld.png",V={__name:"20240804 7 指针分析-基础",setup(F,{expose:r}){const s=JSON.parse('{"title":"7 指针分析-基础","description":"","frontmatter":{"title":"7 指针分析-基础","date":"2024-08-04T00:00:00.000Z","tags":["静态代码分析"],"categories":["静态代码分析"]},"headers":[{"level":2,"title":"7.1 指针分析的规则","slug":"_7-1-指针分析的规则","link":"#_7-1-指针分析的规则","children":[{"level":3,"title":"7.1.1 定义和记号","slug":"_7-1-1-定义和记号","link":"#_7-1-1-定义和记号","children":[]},{"level":3,"title":"7.1.2 规则","slug":"_7-1-2-规则","link":"#_7-1-2-规则","children":[]}]},{"level":2,"title":"7.2 如何实现指针分析","slug":"_7-2-如何实现指针分析","link":"#_7-2-如何实现指针分析","children":[{"level":3,"title":"7.2.1 实现思路","slug":"_7-2-1-实现思路","link":"#_7-2-1-实现思路","children":[]},{"level":3,"title":"7.2.2 指针流图","slug":"_7-2-2-指针流图","link":"#_7-2-2-指针流图","children":[]},{"level":3,"title":"7.2.3 分析的步骤","slug":"_7-2-3-分析的步骤","link":"#_7-2-3-分析的步骤","children":[]}]},{"level":2,"title":"7.3 指针分析算法","slug":"_7-3-指针分析算法","link":"#_7-3-指针分析算法","children":[{"level":3,"title":"7.3.1 算法内容","slug":"_7-3-1-算法内容","link":"#_7-3-1-算法内容","children":[]},{"level":3,"title":"7.3.2 算法分析","slug":"_7-3-2-算法分析","link":"#_7-3-2-算法分析","children":[]},{"level":3,"title":"7.3.3 实例","slug":"_7-3-3-实例","link":"#_7-3-3-实例","children":[]}]},{"level":2,"title":"7.4 带方法调用的指针分析","slug":"_7-4-带方法调用的指针分析","link":"#_7-4-带方法调用的指针分析","children":[{"level":3,"title":"7.4.1 过程间分析与指针分析","slug":"_7-4-1-过程间分析与指针分析","link":"#_7-4-1-过程间分析与指针分析","children":[]},{"level":3,"title":"7.4.2 调用语句的规则","slug":"_7-4-2-调用语句的规则","link":"#_7-4-2-调用语句的规则","children":[]},{"level":3,"title":"7.4.3 过程间的指针分析思路","slug":"_7-4-3-过程间的指针分析思路","link":"#_7-4-3-过程间的指针分析思路","children":[]},{"level":3,"title":"7.4.4 算法","slug":"_7-4-4-算法","link":"#_7-4-4-算法","children":[]}]},{"level":2,"title":"7.5 自检问题","slug":"_7-5-自检问题","link":"#_7-5-自检问题","children":[]}],"relativePath":"pages/posts/静态代码分析/20240804 7 指针分析-基础/20240804 7 指针分析-基础.md","path":"/home/runner/work/LiuZhuJunYa.github.io/LiuZhuJunYa.github.io/pages/posts/静态代码分析/20240804 7 指针分析-基础/20240804 7 指针分析-基础.md","lastUpdated":1731428437000}'),m=x(),e=s.frontmatter||{};return m.meta.frontmatter=Object.assign(m.meta.frontmatter||{},s.frontmatter||{}),u("pageData",s),u("valaxy:frontmatter",e),globalThis.$frontmatter=e,r({frontmatter:{title:"7 指针分析-基础",date:"2024-08-04T00:00:00.000Z",tags:["静态代码分析"],categories:["静态代码分析"]}}),(a,o)=>{const h=p;return g(),c(h,{frontmatter:w(e)},{"main-content-md":t(()=>o[0]||(o[0]=[l("p",null,[n("原文链接："),l("a",{href:"https://static-analysis.cuijiacai.com/07-pta-fd/",target:"_blank",rel:"noreferrer"},"https://static-analysis.cuijiacai.com/07-pta-fd/")],-1),l("h1",{id:"_7-指针分析-基础",tabindex:"-1"},[n("7 指针分析-基础 "),l("a",{class:"header-anchor",href:"#_7-指针分析-基础","aria-label":'Permalink to "7 指针分析-基础"'},"​")],-1),l("h2",{id:"_7-1-指针分析的规则",tabindex:"-1"},[n("7.1 指针分析的规则 "),l("a",{class:"header-anchor",href:"#_7-1-指针分析的规则","aria-label":'Permalink to "7.1 指针分析的规则"'},"​")],-1),l("p",null,"在上一讲的最后，我们提到了Java中的 5 类指针影响型语句（见6.4.2）。在这一讲的前 3 大部分中，我们会重点聚焦于创建、赋值、存储、载入这四种，也就是说，我们会先从过程内分析开始做起；最后第 4 部分里面，我们会引入调用语句，学习全程序的指针分析。",-1),l("h3",{id:"_7-1-1-定义和记号",tabindex:"-1"},[n("7.1.1 定义和记号 "),l("a",{class:"header-anchor",href:"#_7-1-1-定义和记号","aria-label":'Permalink to "7.1.1 定义和记号"'},"​")],-1),l("p",null,"为了后续的表示方便，我们先定义一些表示记号。",-1),l("table",null,[l("thead",null,[l("tr",null,[l("th",{style:{"text-align":"center"}},"内容"),l("th",{style:{"text-align":"center"}},"记号")])]),l("tbody",null,[l("tr",null,[l("td",{style:{"text-align":"center"}},"变量（Variables）"),l("td",{style:{"text-align":"center"}},[l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"x"),l("mo",{separator:"true"},","),l("mi",null,"y"),l("mo",null,"∈"),l("mi",null,"V")]),l("annotation",{encoding:"application/x-tex"},"x, y \\in V")])])])])]),l("tr",null,[l("td",{style:{"text-align":"center"}},"字段（Fields）"),l("td",{style:{"text-align":"center"}},[l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"f"),l("mo",{separator:"true"},","),l("mi",null,"g"),l("mo",null,"∈"),l("mi",null,"F")]),l("annotation",{encoding:"application/x-tex"},"f,g \\in F")])])])])]),l("tr",null,[l("td",{style:{"text-align":"center"}},"对象（Objects）"),l("td",{style:{"text-align":"center"}},[l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"o"),l("mi",null,"i")]),l("mo",{separator:"true"},","),l("msub",null,[l("mi",null,"o"),l("mi",null,"j")]),l("mo",null,"∈"),l("mi",null,"O")]),l("annotation",{encoding:"application/x-tex"},"o_i, o_j \\in O")])])])])]),l("tr",null,[l("td",{style:{"text-align":"center"}},"实例字段（Instance Fields）"),l("td",{style:{"text-align":"center"}},[l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"o"),l("mi",null,"i")]),l("mi",{mathvariant:"normal"},"."),l("mi",null,"f"),l("mo",{separator:"true"},","),l("msub",null,[l("mi",null,"o"),l("mi",null,"j")]),l("mi",{mathvariant:"normal"},"."),l("mi",null,"g"),l("mo",null,"∈"),l("mi",null,"O"),l("mo",null,"×"),l("mi",null,"F")]),l("annotation",{encoding:"application/x-tex"},"o_i.f, o_j.g \\in O\\times F")])])])])])])],-1),l("p",null,"有了上述的记号之后，我们可以形式化的定义什么是指针，以及一个程序中指针的集合。",-1),l("div",{class:"definition"},[l("p",{class:"title"},"定义7.1"),l("p",null,[n("记某程序中的变量集合为 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"V")]),l("annotation",{encoding:"application/x-tex"},"V")])])]),n(" ，字段集合为 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"F")]),l("annotation",{encoding:"application/x-tex"},"F")])])]),n(" ，对象集合为 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"O")]),l("annotation",{encoding:"application/x-tex"},"O")])])]),n(" ，定义这个程序中的某个 "),l("strong",null,"指针（Pointer）"),n(" 为 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"p")]),l("annotation",{encoding:"application/x-tex"},"p")])])]),n(" ，其中 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"p")]),l("annotation",{encoding:"application/x-tex"},"p")])])]),n(" 满足")]),l("p",null,[l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[l("semantics",null,[l("mrow",null,[l("mi",null,"p"),l("mo",null,"∈"),l("mi",null,"V"),l("mo",null,"∪"),l("mo",{stretchy:"false"},"("),l("mi",null,"O"),l("mo",null,"×"),l("mi",null,"F"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"p\\in V\\cup(O\\times F) ")])])])]),l("p",null,[n("记所有的指针组成的集合为 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P"),l("mi",null,"o"),l("mi",null,"i"),l("mi",null,"n"),l("mi",null,"t"),l("mi",null,"e"),l("mi",null,"r")]),l("annotation",{encoding:"application/x-tex"},"Pointer")])])]),n(" ，则 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P"),l("mi",null,"o"),l("mi",null,"i"),l("mi",null,"n"),l("mi",null,"t"),l("mi",null,"e"),l("mi",null,"r")]),l("annotation",{encoding:"application/x-tex"},"Pointer")])])]),n(" 满足")]),l("p",null,[l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P"),l("mi",null,"o"),l("mi",null,"i"),l("mi",null,"n"),l("mi",null,"t"),l("mi",null,"e"),l("mi",null,"r"),l("mo",null,"⊆"),l("mi",null,"V"),l("mo",null,"∪"),l("mo",{stretchy:"false"},"("),l("mi",null,"O"),l("mo",null,"×"),l("mi",null,"F"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"Pointer \\subseteq V\\cup(O\\times F) ")])])])])],-1),l("p",null,"指针分析的目的是输出整个程序中所有的指向关系，根据上述定义，我们也可以形式化的定义出指向关系。",-1),l("div",{class:"definition"},[l("p",{class:"title"},"定义7.2"),l("p",null,[n("记程序的指针集为 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P"),l("mi",null,"o"),l("mi",null,"i"),l("mi",null,"n"),l("mi",null,"t"),l("mi",null,"e"),l("mi",null,"r")]),l("annotation",{encoding:"application/x-tex"},"Pointer")])])]),n(" ， 对象集合为 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"O")]),l("annotation",{encoding:"application/x-tex"},"O")])])]),n(" ，其幂集记为 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P"),l("mo",{stretchy:"false"},"("),l("mi",null,"O"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"P(O)")])])]),n(" ，定义 "),l("strong",null,"指向关系（Points-to Relation）"),n(" 是从 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P"),l("mi",null,"o"),l("mi",null,"i"),l("mi",null,"n"),l("mi",null,"t"),l("mi",null,"e"),l("mi",null,"r")]),l("annotation",{encoding:"application/x-tex"},"Pointer")])])]),n(" 到 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P"),l("mo",{stretchy:"false"},"("),l("mi",null,"O"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"P(O)")])])]),n(" 映射，用 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"p"),l("mi",null,"t")]),l("annotation",{encoding:"application/x-tex"},"pt")])])]),n(" 表示，满足")]),l("p",null,[l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[l("semantics",null,[l("mrow",null,[l("mi",null,"p"),l("mi",null,"t"),l("mo",null,"⊆"),l("mi",null,"P"),l("mi",null,"o"),l("mi",null,"i"),l("mi",null,"n"),l("mi",null,"t"),l("mi",null,"e"),l("mi",null,"r"),l("mo",null,"×"),l("mi",null,"P"),l("mo",{stretchy:"false"},"("),l("mi",null,"O"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"pt \\subseteq Pointer \\times P(O) ")])])])]),l("p",null,[n("于是，我们可以用 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"p"),l("mi",null,"t"),l("mo",{stretchy:"false"},"("),l("mi",null,"p"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"pt(p)")])])]),n(" 来表示指针 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"p")]),l("annotation",{encoding:"application/x-tex"},"p")])])]),n(" 的 "),l("strong",null,"指向集合（Points-to Set）"),n(" 。")])],-1),l("h3",{id:"_7-1-2-规则",tabindex:"-1"},[n("7.1.2 规则 "),l("a",{class:"header-anchor",href:"#_7-1-2-规则","aria-label":'Permalink to "7.1.2 规则"'},"​")],-1),l("p",null,"我们用推导式的方式来描述各种语句在指针分析中的规则。",-1),l("div",{class:"definition"},[l("p",{class:"title"},"定义7.3"),l("p",null,[n("考虑命题 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"P"),l("mn",null,"1")]),l("mo",{separator:"true"},","),l("msub",null,[l("mi",null,"P"),l("mn",null,"2")]),l("mo",{separator:"true"},","),l("mi",{mathvariant:"normal"},"."),l("mi",{mathvariant:"normal"},"."),l("mi",{mathvariant:"normal"},"."),l("msub",null,[l("mi",null,"P"),l("mi",null,"m")])]),l("annotation",{encoding:"application/x-tex"},"P_1, P_2, ... P_m")])])]),n(" 和 命题 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"Q"),l("mn",null,"1")]),l("mo",{separator:"true"},","),l("msub",null,[l("mi",null,"Q"),l("mn",null,"2")]),l("mo",{separator:"true"},","),l("mi",{mathvariant:"normal"},"."),l("mi",{mathvariant:"normal"},"."),l("mi",{mathvariant:"normal"},"."),l("mo",{separator:"true"},","),l("msub",null,[l("mi",null,"Q"),l("mi",null,"n")])]),l("annotation",{encoding:"application/x-tex"},"Q_1, Q_2, ..., Q_n")])])]),n(" ，定义 "),l("strong",null,"推导式（Comprehension）"),n(" 形式如下：")]),l("p",null,[l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[l("semantics",null,[l("mrow",null,[l("mfrac",null,[l("mrow",null,[l("msub",null,[l("mi",null,"P"),l("mn",null,"1")]),l("mo",{separator:"true"},","),l("msub",null,[l("mi",null,"P"),l("mn",null,"2")]),l("mo",{separator:"true"},","),l("mi",{mathvariant:"normal"},"."),l("mi",{mathvariant:"normal"},"."),l("mi",{mathvariant:"normal"},"."),l("mo",{separator:"true"},","),l("msub",null,[l("mi",null,"P"),l("mi",null,"m")])]),l("mrow",null,[l("msub",null,[l("mi",null,"Q"),l("mn",null,"1")]),l("mo",{separator:"true"},","),l("msub",null,[l("mi",null,"Q"),l("mn",null,"2")]),l("mo",{separator:"true"},","),l("mi",{mathvariant:"normal"},"."),l("mi",{mathvariant:"normal"},"."),l("mi",{mathvariant:"normal"},"."),l("mo",{separator:"true"},","),l("msub",null,[l("mi",null,"Q"),l("mi",null,"n")])])])]),l("annotation",{encoding:"application/x-tex"},"\\frac{P_1, P_2, ..., P_m}{Q_1, Q_2, ..., Q_n} ")])])])]),l("p",null,[n("其含义是，若 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"P"),l("mn",null,"1")]),l("mo",{separator:"true"},","),l("msub",null,[l("mi",null,"P"),l("mn",null,"2")]),l("mo",{separator:"true"},","),l("mi",{mathvariant:"normal"},"."),l("mi",{mathvariant:"normal"},"."),l("mi",{mathvariant:"normal"},"."),l("msub",null,[l("mi",null,"P"),l("mi",null,"m")])]),l("annotation",{encoding:"application/x-tex"},"P_1, P_2, ... P_m")])])]),n(" 为真，则 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"Q"),l("mn",null,"1")]),l("mo",{separator:"true"},","),l("msub",null,[l("mi",null,"Q"),l("mn",null,"2")]),l("mo",{separator:"true"},","),l("mi",{mathvariant:"normal"},"."),l("mi",{mathvariant:"normal"},"."),l("mi",{mathvariant:"normal"},"."),l("mo",{separator:"true"},","),l("msub",null,[l("mi",null,"Q"),l("mi",null,"n")])]),l("annotation",{encoding:"application/x-tex"},"Q_1, Q_2, ..., Q_n")])])]),n(" 为真。 其中，"),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"P"),l("mi",null,"i")])]),l("annotation",{encoding:"application/x-tex"},"P_i")])])]),n(" 称为 "),l("strong",null,"前提（Premises）"),n(" ， "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"Q"),l("mi",null,"j")])]),l("annotation",{encoding:"application/x-tex"},"Q_j")])])]),n(" 称为 "),l("strong",null,"结论（Conclusion）"),n(" 。 若 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"m"),l("mo",null,"="),l("mn",null,"0")]),l("annotation",{encoding:"application/x-tex"},"m = 0")])])]),n(" ，则称结论 "),l("strong",null,"无条件（Unconditional）"),n(" 成立。")])],-1),l("p",null,"于是各种类型语句的规则可以用下表表示：",-1),l("table",null,[l("thead",null,[l("tr",null,[l("th",{style:{"text-align":"center"}},"类型"),l("th",{style:{"text-align":"center"}},"语句"),l("th",{style:{"text-align":"center"}},"规则"),l("th",{style:{"text-align":"center"}},"图示")])]),l("tbody",null,[l("tr",null,[l("td",{style:{"text-align":"center"}},"创建"),l("td",{style:{"text-align":"center"}},[l("code",null,"i: x = new T()")]),l("td",{style:{"text-align":"center"}},[l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mover",{accent:"true"},[l("mrow",null,[l("msub",null,[l("mi",null,"o"),l("mi",null,"i")]),l("mo",null,"∈"),l("mi",null,"p"),l("mi",null,"t"),l("mo",{stretchy:"false"},"("),l("mi",null,"x"),l("mo",{stretchy:"false"},")")]),l("mo",{stretchy:"true"},"‾")])]),l("annotation",{encoding:"application/x-tex"},"\\overline{o_i \\in pt(x)}")])])])]),l("td",{style:{"text-align":"center"}},[l("img",{src:d,alt:"new",style:{zoom:"30%"}})])]),l("tr",null,[l("td",{style:{"text-align":"center"}},"赋值"),l("td",{style:{"text-align":"center"}},[l("code",null,"x = y")]),l("td",{style:{"text-align":"center"}},[l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"o"),l("mi",null,"i")]),l("mo",null,"∈"),l("mi",null,"p"),l("mi",null,"t"),l("mo",{stretchy:"false"},"("),l("mi",null,"y"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"o_i\\in pt(y)")])])]),l("br"),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mover",{accent:"true"},[l("mrow",null,[l("msub",null,[l("mi",null,"o"),l("mi",null,"i")]),l("mo",null,"∈"),l("mi",null,"p"),l("mi",null,"t"),l("mo",{stretchy:"false"},"("),l("mi",null,"x"),l("mo",{stretchy:"false"},")")]),l("mo",{stretchy:"true"},"‾")])]),l("annotation",{encoding:"application/x-tex"},"\\overline{o_i \\in pt(x)}")])])])]),l("td",{style:{"text-align":"center"}},[l("img",{src:k,alt:"assign",style:{zoom:"30%"}})])]),l("tr",null,[l("td",{style:{"text-align":"center"}},"存储"),l("td",{style:{"text-align":"center"}},[l("code",null,"x.f = y")]),l("td",{style:{"text-align":"center"}},[l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("munder",{accentunder:"true"},[l("mrow",null,[l("msub",null,[l("mi",null,"o"),l("mi",null,"i")]),l("mo",null,"∈"),l("mi",null,"p"),l("mi",null,"t"),l("mo",{stretchy:"false"},"("),l("mi",null,"x"),l("mo",{stretchy:"false"},")"),l("mo",{separator:"true"},","),l("msub",null,[l("mi",null,"o"),l("mi",null,"j")]),l("mo",null,"∈"),l("mi",null,"p"),l("mi",null,"t"),l("mo",{stretchy:"false"},"("),l("mi",null,"y"),l("mo",{stretchy:"false"},")")]),l("mo",{stretchy:"true"},"‾")])]),l("annotation",{encoding:"application/x-tex"},"\\underline{o_i \\in pt(x), o_j\\in pt(y)}")])])]),l("br"),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"o"),l("mi",null,"j")]),l("mo",null,"∈"),l("mi",null,"p"),l("mi",null,"t"),l("mo",{stretchy:"false"},"("),l("msub",null,[l("mi",null,"o"),l("mi",null,"i")]),l("mi",{mathvariant:"normal"},"."),l("mi",null,"f"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"o_j \\in pt(o_i.f)")])])])]),l("td",{style:{"text-align":"center"}},[l("img",{src:M,alt:"store",style:{zoom:"30%"}})])]),l("tr",null,[l("td",{style:{"text-align":"center"}},"载入"),l("td",{style:{"text-align":"center"}},[l("code",null,"y = x.f")]),l("td",{style:{"text-align":"center"}},[l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("munder",{accentunder:"true"},[l("mrow",null,[l("msub",null,[l("mi",null,"o"),l("mi",null,"i")]),l("mo",null,"∈"),l("mi",null,"p"),l("mi",null,"t"),l("mo",{stretchy:"false"},"("),l("mi",null,"x"),l("mo",{stretchy:"false"},")"),l("mo",{separator:"true"},","),l("msub",null,[l("mi",null,"o"),l("mi",null,"j")]),l("mo",null,"∈"),l("mi",null,"p"),l("mi",null,"t"),l("mo",{stretchy:"false"},"("),l("msub",null,[l("mi",null,"o"),l("mi",null,"i")]),l("mi",{mathvariant:"normal"},"."),l("mi",null,"f"),l("mo",{stretchy:"false"},")")]),l("mo",{stretchy:"true"},"‾")])]),l("annotation",{encoding:"application/x-tex"},"\\underline{o_i\\in pt(x), o_j\\in pt(o_i.f)}")])])]),l("br"),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"o"),l("mi",null,"j")]),l("mo",null,"∈"),l("mi",null,"p"),l("mi",null,"t"),l("mo",{stretchy:"false"},"("),l("mi",null,"y"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"o_j\\in pt(y)")])])])]),l("td",{style:{"text-align":"center"}},[l("img",{src:y,alt:"load",style:{zoom:"30%"}})])])])],-1),l("blockquote",null,[l("p",null,"其中，图示用红色虚线表示作为前提的指向关系，用黑色实线表示结论得出的指向关系。")],-1),l("h2",{id:"_7-2-如何实现指针分析",tabindex:"-1"},[n("7.2 如何实现指针分析 "),l("a",{class:"header-anchor",href:"#_7-2-如何实现指针分析","aria-label":'Permalink to "7.2 如何实现指针分析"'},"​")],-1),l("h3",{id:"_7-2-1-实现思路",tabindex:"-1"},[n("7.2.1 实现思路 "),l("a",{class:"header-anchor",href:"#_7-2-1-实现思路","aria-label":'Permalink to "7.2.1 实现思路"'},"​")],-1),l("p",null,"指针分析就是要在指针（变量或者实例字段）之间传播(propagate)指向信息。",-1),l("p",{style:{"text-align":"center"}},[l("img",{src:b,alt:"propagate",style:{zoom:"40%"}})],-1),l("div",{class:"definition"},[l("p",{class:"title"},"定义7.4"),l("p",null,[n("我们根据语句的语义确定了一系列的指向集合传播规则，从而我们可以将指针分析的过程视为求解一个 "),l("strong",null,"包含约束(Inclusion Constraints)"),n(" 系统的过程，这种分析风格被称为 "),l("strong",null,"安德森式分析（Andersen-Style Analysis）"),n(" 。")])],-1),l("p",null,[n("实现指针分析的关键是当 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"p"),l("mi",null,"t"),l("mo",{stretchy:"false"},"("),l("mi",null,"x"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"pt(x)")])])]),n(" 改变的时候，将改变的部分传递给和 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"x")]),l("annotation",{encoding:"application/x-tex"},"x")])])]),n(" 相关的其他指针。")],-1),l("p",null,"因此，我们的解决方案是：",-1),l("ul",null,[l("li",null,[l("p",null,"使用一个图来连接相关的指针；")]),l("li",null,[l("p",null,[n("当 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"p"),l("mi",null,"t"),l("mo",{stretchy:"false"},"("),l("mi",null,"x"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"pt(x)")])])]),n(" 改变的时候，将改变的部分传递给 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"x")]),l("annotation",{encoding:"application/x-tex"},"x")])])]),n(" 的后继们。")])])],-1),l("h3",{id:"_7-2-2-指针流图",tabindex:"-1"},[n("7.2.2 指针流图 "),l("a",{class:"header-anchor",href:"#_7-2-2-指针流图","aria-label":'Permalink to "7.2.2 指针流图"'},"​")],-1),l("div",{class:"definition"},[l("p",{class:"title"},"定义7.5"),l("p",null,[n("一个程序的 "),l("strong",null,"指针流图(Pointer Flow Graph)"),n(" 指的是表示对象如何在程序中的指针之间流动的有向图。")]),l("ul",null,[l("li",null,[n("PFG中的一个节点 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"n")]),l("annotation",{encoding:"application/x-tex"},"n")])])]),n(" 代表了一个变量或者某个对象的一个字段，即")])]),l("p",null,[l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[l("semantics",null,[l("mrow",null,[l("mi",null,"n"),l("mo",null,"∈"),l("mi",null,"P"),l("mi",null,"o"),l("mi",null,"i"),l("mi",null,"n"),l("mi",null,"t"),l("mi",null,"e"),l("mi",null,"r"),l("mo",null,"⊆"),l("mi",null,"V"),l("mo",null,"∪"),l("mo",{stretchy:"false"},"("),l("mi",null,"O"),l("mo",null,"×"),l("mi",null,"F"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"n \\in Pointer \\subseteq V \\cup (O\\times F) ")])])])]),l("ul",null,[l("li",null,[n("PFG中的一条边 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"x"),l("mo",null,"→"),l("mi",null,"y"),l("mo",null,"∈"),l("mi",null,"P"),l("mi",null,"o"),l("mi",null,"i"),l("mi",null,"n"),l("mi",null,"t"),l("mi",null,"e"),l("mi",null,"r"),l("mo",null,"×"),l("mi",null,"P"),l("mi",null,"o"),l("mi",null,"i"),l("mi",null,"n"),l("mi",null,"t"),l("mi",null,"e"),l("mi",null,"r")]),l("annotation",{encoding:"application/x-tex"},"x \\to y \\in Pointer\\times Pointer")])])]),n(" 表示指针 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"x")]),l("annotation",{encoding:"application/x-tex"},"x")])])]),n(" 指向的对象可能会流到指针 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"y")]),l("annotation",{encoding:"application/x-tex"},"y")])])]),n(" 的指向集合中（即也可能被 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"y")]),l("annotation",{encoding:"application/x-tex"},"y")])])]),n(" 指向）。")])]),l("p",null,[n("其中， "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"V")]),l("annotation",{encoding:"application/x-tex"},"V")])])]),n(" 表示程序中所有变量的集合， "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"O")]),l("annotation",{encoding:"application/x-tex"},"O")])])]),n(" 表示所有对象的集合， "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"F")]),l("annotation",{encoding:"application/x-tex"},"F")])])]),n(" 表示所有字段的集合。")])],-1),l("p",null,"PFG的节点是容易确定的，就是程序中所有的指针；于是，我们只需要根据程序中的语句以及语句对应的规则添加PFG的边即可。",-1),l("p",{style:{"text-align":"center"}},[l("img",{src:f,alt:"pfg-edges",style:{zoom:"40%"}})],-1),l("p",null,"比如说下面这个例子：",-1),l("p",{style:{"text-align":"center"}},[l("img",{src:_,alt:"pfg-eg",style:{zoom:"40%"}})],-1),l("p",null,"有了PFG之后，指针分析就可以通过计算PFG的传递闭包（Transitive Closure）来解决。",-1),l("p",null,[n("比如说，在上面的例子中，"),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"e")]),l("annotation",{encoding:"application/x-tex"},"e")])])]),n(" 是从 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"b")]),l("annotation",{encoding:"application/x-tex"},"b")])])]),n(" 可达的结点，这就意味着所有的 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"b")]),l("annotation",{encoding:"application/x-tex"},"b")])])]),n(" 指向的对象都可能会流向 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"e")]),l("annotation",{encoding:"application/x-tex"},"e")])])]),n(" ，也就是可能还会被 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"e")]),l("annotation",{encoding:"application/x-tex"},"e")])])]),n(" 指向。")],-1),l("h3",{id:"_7-2-3-分析的步骤",tabindex:"-1"},[n("7.2.3 分析的步骤 "),l("a",{class:"header-anchor",href:"#_7-2-3-分析的步骤","aria-label":'Permalink to "7.2.3 分析的步骤"'},"​")],-1),l("p",null,[n("如果程序中有这样一句语句： "),l("code",null,"j: b = new T()"),n(" ，显然有 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"o"),l("mi",null,"j")]),l("mo",null,"∈"),l("mi",null,"p"),l("mi",null,"t"),l("mo",{stretchy:"false"},"("),l("mi",null,"b"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"o_j \\in pt(b)")])])]),n(" ，根据PFG，也会有 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"o"),l("mi",null,"j")]),l("mo",null,"∈"),l("mi",null,"p"),l("mi",null,"t"),l("mo",{stretchy:"false"},"("),l("mi",null,"a"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"o_j \\in pt(a)")])])]),n(" ， "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"o"),l("mi",null,"j")]),l("mo",null,"∈"),l("mi",null,"p"),l("mi",null,"t"),l("mo",{stretchy:"false"},"("),l("msub",null,[l("mi",null,"o"),l("mi",null,"i")]),l("mi",{mathvariant:"normal"},"."),l("mi",null,"f"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"o_j \\in pt(o_i.f)")])])]),n(" ， "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"o"),l("mi",null,"j")]),l("mo",null,"∈"),l("mi",null,"p"),l("mi",null,"t"),l("mo",{stretchy:"false"},"("),l("mi",null,"e"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"o_j \\in pt(e)")])])]),n(" 。")],-1),l("p",null,"所以，指针分析的实现可以分两步：",-1),l("ul",null,[l("li",null,[l("p",null,"构建指针流图 PFG")]),l("li",null,[l("p",null,"在 PFG 上传递指向信息")])],-1),l("p",null,[n("但是，上面这两步是没有严格的先后关系的。考虑存储语句和载入语句（即上面例子中的2、4、5行），一个指针是没有字段的，当我们通过指针来访问字段的时候，其实访问的是指针指向的对象的字段，也就是说，图中的2、4、5这3条边的构建就已经使用到了 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"o"),l("mi",null,"i")]),l("mo",null,"∈"),l("mi",null,"p"),l("mi",null,"t"),l("mo",{stretchy:"false"},"("),l("mi",null,"c"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"o_i \\in pt(c)")])])]),n(" 和 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"o"),l("mi",null,"i")]),l("mo",null,"∈"),l("mi",null,"p"),l("mi",null,"t"),l("mo",{stretchy:"false"},"("),l("mi",null,"d"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"o_i \\in pt(d)")])])]),n(" 这两条指向信息了。")],-1),l("p",null,"因此，我们发现，构建指针流图是需要用到指向信息的，而传递指向信息又需要指针流图的基础，因此上面所说的两步是相互依赖（Mutually Dependent）的。",-1),l("p",null,"总结一下就是：",-1),l("div",{class:"conclusion"},[l("p",{class:"title"},"结论7.1"),l("p",null,[n("指针流图是在指针分析的过程当中 "),l("strong",null,"动态更新（Dynamically Updated）"),n(" 的。")])],-1),l("h2",{id:"_7-3-指针分析算法",tabindex:"-1"},[n("7.3 指针分析算法 "),l("a",{class:"header-anchor",href:"#_7-3-指针分析算法","aria-label":'Permalink to "7.3 指针分析算法"'},"​")],-1),l("h3",{id:"_7-3-1-算法内容",tabindex:"-1"},[n("7.3.1 算法内容 "),l("a",{class:"header-anchor",href:"#_7-3-1-算法内容","aria-label":'Permalink to "7.3.1 算法内容"'},"​")],-1),l("div",{class:"algorithm"},[l("p",{class:"title"},"算法7.1 过程内上下文不敏感的全程序指针分析算法"),l("iframe",{src:"/posts/StaticAnalytics/07-pta-fd/intra-pta.html",frameborder:"no",border:"0",marginwidth:"0",width:"100%",height:"1050px",marginheight:"0",scrolling:"auto",style:{"box-shadow":"none"}})],-1),l("h3",{id:"_7-3-2-算法分析",tabindex:"-1"},[n("7.3.2 算法分析 "),l("a",{class:"header-anchor",href:"#_7-3-2-算法分析","aria-label":'Permalink to "7.3.2 算法分析"'},"​")],-1),l("h4",{id:"工作列表",tabindex:"-1"},[n("工作列表 "),l("a",{class:"header-anchor",href:"#工作列表","aria-label":'Permalink to "工作列表"'},"​")],-1),l("ul",null,[l("li",null,"工作列表（Worklist）包含了即将被处理的指向信息。")],-1),l("p",null,[l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[l("semantics",null,[l("mrow",null,[l("mi",null,"W"),l("mi",null,"L"),l("mo",null,"⊆"),l("mi",null,"P"),l("mi",null,"o"),l("mi",null,"i"),l("mi",null,"n"),l("mi",null,"t"),l("mi",null,"e"),l("mi",null,"r"),l("mo",null,"×"),l("mi",null,"P"),l("mo",{stretchy:"false"},"("),l("mi",null,"O"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"WL \\subseteq Pointer \\times P(O) ")])])])],-1),l("ul",null,[l("li",null,[l("p",null,[n("每个工作列表里面的表项 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mo",{stretchy:"false"},"("),l("mi",null,"n"),l("mo",{separator:"true"},","),l("mi",null,"p"),l("mi",null,"t"),l("mi",null,"s"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"(n, pts)")])])]),n(" 是一个指针 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"n")]),l("annotation",{encoding:"application/x-tex"},"n")])])]),n(" 和 指向集合 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"p"),l("mi",null,"t"),l("mi",null,"s")]),l("annotation",{encoding:"application/x-tex"},"pts")])])]),n(" 的有序对，意味着 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"p"),l("mi",null,"t"),l("mi",null,"s")]),l("annotation",{encoding:"application/x-tex"},"pts")])])]),n(" 应当被传递给 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"p"),l("mi",null,"t"),l("mo",{stretchy:"false"},"("),l("mi",null,"n"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"pt(n)")])])])]),l("p",null,[l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[l("semantics",null,[l("mrow",null,[l("mo",{stretchy:"false"},"["),l("mo",{stretchy:"false"},"("),l("mi",null,"x"),l("mo",{separator:"true"},","),l("mo",{stretchy:"false"},"{"),l("msub",null,[l("mi",null,"o"),l("mi",null,"i")]),l("mo",{stretchy:"false"},"}"),l("mo",{stretchy:"false"},")"),l("mo",{separator:"true"},","),l("mo",{stretchy:"false"},"("),l("mi",null,"y"),l("mo",{separator:"true"},","),l("mo",{stretchy:"false"},"{"),l("msub",null,[l("mi",null,"o"),l("mi",null,"j")]),l("mo",{separator:"true"},","),l("msub",null,[l("mi",null,"o"),l("mi",null,"k")]),l("mo",{stretchy:"false"},"}"),l("mo",{stretchy:"false"},")"),l("mo",{separator:"true"},","),l("mo",{stretchy:"false"},"("),l("msub",null,[l("mi",null,"o"),l("mi",null,"j")]),l("mi",{mathvariant:"normal"},"."),l("mi",null,"f"),l("mo",{separator:"true"},","),l("mo",{stretchy:"false"},"{"),l("msub",null,[l("mi",null,"o"),l("mi",null,"l")]),l("mo",{stretchy:"false"},"}"),l("mo",{stretchy:"false"},")"),l("mo",{separator:"true"},","),l("mi",{mathvariant:"normal"},"."),l("mi",{mathvariant:"normal"},"."),l("mi",{mathvariant:"normal"},"."),l("mo",{stretchy:"false"},"]")]),l("annotation",{encoding:"application/x-tex"},"[(x, \\{o_i\\}), (y, \\{o_j, o_k\\}), (o_j.f, \\{o_l\\}), ...] ")])])])])])],-1),l("h4",{id:"处理-new-和-assign",tabindex:"-1"},[n("处理 "),l("code",null,"New"),n(" 和 "),l("code",null,"Assign"),n(),l("a",{class:"header-anchor",href:"#处理-new-和-assign","aria-label":'Permalink to "处理 `New` 和 `Assign`"'},"​")],-1),l("p",null,"算法的第 8 - 13 行是对创建语句和赋值语句的处理。创建语句的规则是无条件的，所以它们是我们算法指向关系的初始状态。赋值语句是最简单的 PFG 边，在添加边的子过程中（算法第 31 - 38 行），我们主要做了 3 个步骤：",-1),l("ol",null,[l("li",null,[l("p",null,[n("如果 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"s"),l("mo",null,"→"),l("mi",null,"t")]),l("annotation",{encoding:"application/x-tex"},"s\\to t")])])]),n(" 已经在 PFG 中，则啥也不干，避免冗余操作（第 32 行）")])]),l("li",null,[l("p",null,"添加 PFG 边（第 33 行）")]),l("li",null,[l("p",null,[n("保证每个 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"s")]),l("annotation",{encoding:"application/x-tex"},"s")])])]),n(" 指向的对象也被 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"t")]),l("annotation",{encoding:"application/x-tex"},"t")])])]),n(" 指向（第 34 - 36 行）")])])],-1),l("p",null,[n("在算法的第 14 - 17 行是对于工作列表中的表项的处理，后面 18 - 27 行是对于 "),l("code",null,"Store"),n(" 和 "),l("code",null,"Load"),n(" 的处理，我们这里暂时不考虑。")],-1),l("p",null,[n("对于工作列表中的每个表项，我们将其取出（第 15 行），然后取 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"p"),l("mi",null,"t"),l("mi",null,"s")]),l("annotation",{encoding:"application/x-tex"},"pts")])])]),n(" 中还不在 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"p"),l("mi",null,"t"),l("mo",{stretchy:"false"},"("),l("mi",null,"n"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"pt(n)")])])]),n(" 里面的那部分对象集合（第 16 行），这是为了避免冗余的操作，然后通过子过程 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P"),l("mi",null,"r"),l("mi",null,"o"),l("mi",null,"p"),l("mi",null,"a"),l("mi",null,"g"),l("mi",null,"a"),l("mi",null,"t"),l("mi",null,"e"),l("mo",{stretchy:"false"},"("),l("mi",null,"n"),l("mo",{separator:"true"},","),l("mi",{mathvariant:"normal"},"Δ"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"Propagate(n, \\Delta)")])])]),n(" 将 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",{mathvariant:"normal"},"Δ")]),l("annotation",{encoding:"application/x-tex"},"\\Delta")])])]),n(" 传播给 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"n")]),l("annotation",{encoding:"application/x-tex"},"n")])])]),n(" 及其后继。")],-1),l("p",null,"在第 40 - 47 行的传播子过程，我们主要干了下面 3 个步骤：",-1),l("ol",null,[l("li",null,[l("p",null,[n("如果 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"p"),l("mi",null,"t"),l("mi",null,"s")]),l("annotation",{encoding:"application/x-tex"},"pts")])])]),n(" 是空集，则啥也不干，因为空集就没必要向后传播了（第 41 行）")])]),l("li",null,[l("p",null,[n("将 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"p"),l("mi",null,"t"),l("mi",null,"s")]),l("annotation",{encoding:"application/x-tex"},"pts")])])]),n(" 传播给 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"n")]),l("annotation",{encoding:"application/x-tex"},"n")])])]),n(" 的指向集合 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"p"),l("mi",null,"t"),l("mo",{stretchy:"false"},"("),l("mi",null,"n"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"pt(n)")])])]),n("（第 42 行）")])]),l("li",null,[l("p",null,[n("将 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"p"),l("mi",null,"t"),l("mi",null,"s")]),l("annotation",{encoding:"application/x-tex"},"pts")])])]),n(" 传播给 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"n")]),l("annotation",{encoding:"application/x-tex"},"n")])])]),n(" 在 PFG 上的后继结点（第 43 - 45 行）。")])])],-1),l("blockquote",null,[l("p",null,[n("这里的 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"p"),l("mi",null,"t"),l("mi",null,"s")]),l("annotation",{encoding:"application/x-tex"},"pts")])])]),n(" 是在原来的指向集合基础上新增的对象集合，因为我们第 17 行传入的参数是 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",{mathvariant:"normal"},"Δ")]),l("annotation",{encoding:"application/x-tex"},"\\Delta")])])]),n(" 。")])],-1),l("h4",{id:"差量传播",tabindex:"-1"},[n("差量传播 "),l("a",{class:"header-anchor",href:"#差量传播","aria-label":'Permalink to "差量传播"'},"​")],-1),l("div",{class:"definition"},[l("p",{class:"title"},"定义7.6"),l("p",null,[n("称算法7.1第 16 - 17 行避免处理和传播冗余指向信息的做法为 "),l("strong",null,"差量传播（Differential Propagation）"),n(" 。")])],-1),l("p",null,[n("使用差量传播的原因是算法的过程保证了现存于 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"p"),l("mo",{stretchy:"false"},"("),l("mi",null,"n"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"p(n)")])])]),n(" 中的指向信息已经被传播给 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"n")]),l("annotation",{encoding:"application/x-tex"},"n")])])]),n(" 的后继了，也就不需要再次被传播了。")],-1),l("p",null,[n("实际上，和已有的指向集合相比， "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",{mathvariant:"normal"},"Δ")]),l("annotation",{encoding:"application/x-tex"},"\\Delta")])])]),n(" 通常是很小的，所以仅仅传播新的指向信息 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",{mathvariant:"normal"},"Δ")]),l("annotation",{encoding:"application/x-tex"},"\\Delta")])])]),n(" 能够极大地提升效率。")],-1),l("p",null,[n("除此之外， "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",{mathvariant:"normal"},"Δ")]),l("annotation",{encoding:"application/x-tex"},"\\Delta")])])]),n(" 在处理存储、载入以及调用语句的时候对于效率的提升也很有作用，这些会在后续加以解释。")],-1),l("h4",{id:"处理-store-和-load",tabindex:"-1"},[n("处理 "),l("code",null,"Store"),n(" 和 "),l("code",null,"Load"),n(),l("a",{class:"header-anchor",href:"#处理-store-和-load","aria-label":'Permalink to "处理 `Store` 和 `Load`"'},"​")],-1),l("p",null,[n("在算法7.1的第 18 - 27 行，我们处理了 "),l("code",null,"Store"),n(" 和 "),l("code",null,"Load"),n(" 语句，这两种语句的指针流是会受已知的指向关系的影响的，新的指向关系可能会在这两种语句的作用下引入新的PFG边")],-1),l("p",null,[n("因为我们是基于3地址码的IR讨论的指针分析，所以不存在实例域的嵌套访问，也就是说我们只会通过变量访问实例域（详见6.4.2），因此才有了第 18 行的判断，可以避免后续冗余的处理（如果 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"n")]),l("annotation",{encoding:"application/x-tex"},"n")])])]),n(" 是一个实例字段，则不会存在关于 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"n")]),l("annotation",{encoding:"application/x-tex"},"n")])])]),n(" 的 "),l("code",null,"Store"),n(" 和 "),l("code",null,"Load"),n(" 语句）。")],-1),l("p",null,[n("具体的处理很简单，对于所有指向集中新增的对象，更新和这个变量相关 "),l("code",null,"Store"),n(" 和 "),l("code",null,"Load"),n(" 语句产生的PFG边。")],-1),l("p",null,[n("一个 "),l("code",null,"Assign"),n(" 语句只会产生一个PFG边，而一个 "),l("code",null,"Store"),n(" 或者 "),l("code",null,"Load"),n(" 语句可能会产生多个PFG边。")],-1),l("h3",{id:"_7-3-3-实例",tabindex:"-1"},[n("7.3.3 实例 "),l("a",{class:"header-anchor",href:"#_7-3-3-实例","aria-label":'Permalink to "7.3.3 实例"'},"​")],-1),l("p",null,"比如说下面这段程序：",-1),l("div",{class:"language-java vp-adaptive-theme"},[l("button",{title:"Copy Code",class:"copy"}),l("span",{class:"lang"},"java"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"b "),l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," C"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),n(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"a "),l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," b;")]),n(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"c "),l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," C"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),n(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"c.f "),l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," a;")]),n(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"d "),l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," c;")]),n(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"c.f "),l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," d;")]),n(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"e "),l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," d.f;")])])]),l("button",{class:"collapse"})],-1),l("p",null,"应用算法7.1，可以得到对应的PFG以及各指针结点的指向集合为：",-1),l("p",{style:{"text-align":"center"}},[l("img",{src:E,alt:"pta-intra-alg-eg",style:{zoom:"27%"}})],-1),l("h2",{id:"_7-4-带方法调用的指针分析",tabindex:"-1"},[n("7.4 带方法调用的指针分析 "),l("a",{class:"header-anchor",href:"#_7-4-带方法调用的指针分析","aria-label":'Permalink to "7.4 带方法调用的指针分析"'},"​")],-1),l("h3",{id:"_7-4-1-过程间分析与指针分析",tabindex:"-1"},[n("7.4.1 过程间分析与指针分析 "),l("a",{class:"header-anchor",href:"#_7-4-1-过程间分析与指针分析","aria-label":'Permalink to "7.4.1 过程间分析与指针分析"'},"​")],-1),l("p",null,"过程间的指针分析需要调用图，我们之前调用图的构建方式是CHA，基于变量的声明类型来解析目标方法。不过这是极不精确的，因为CHA会引入很多虚假的调用边和指向关系。",-1),l("p",null,[n("而如果有了指针分析的话，我们就不必根据声明类型来解析目标方法，可以根据更精确的指向关系，即 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"p"),l("mi",null,"t"),l("mo",{stretchy:"false"},"("),l("mi",null,"x"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"pt(x)")])])]),n(" 来解析目标方法了。而指针分析就会比CHA精确得多了，无论是在调用图构建还是在指向关系方面。")],-1),l("p",null,"基于指针分析来构建调用图的过程中，反过来又会促进指针分析的过程，因为调用边和返回边也是会传递指向关系的，从而两者是相互依赖的，我们称这种调用图的构建方式为即时调用图构建（On-the-fly Call Graph Construction）。",-1),l("div",{class:"definition"},[l("p",{class:"title"},"定义7.7"),l("p",null,[n("称一边使用调用图，一边构建调用图的方式为"),l("strong",null,"即时调用图构建（On-the-fly Call Graph Construction）"),n("。")])],-1),l("h3",{id:"_7-4-2-调用语句的规则",tabindex:"-1"},[n("7.4.2 调用语句的规则 "),l("a",{class:"header-anchor",href:"#_7-4-2-调用语句的规则","aria-label":'Permalink to "7.4.2 调用语句的规则"'},"​")],-1),l("table",null,[l("thead",null,[l("tr",null,[l("th",{style:{"text-align":"center"}},"类型"),l("th",{style:{"text-align":"center"}},"语句"),l("th",{style:{"text-align":"center"}},"规则"),l("th",{style:{"text-align":"center"}},"PFG边")])]),l("tbody",null,[l("tr",null,[l("td",{style:{"text-align":"center"}},"调用"),l("td",{style:{"text-align":"center"}},[l("code",null,"l: r = x.k(a1, ..., an)")]),l("td",{style:{"text-align":"center"}},[l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"o"),l("mi",null,"i")]),l("mo",null,"∈"),l("mi",null,"p"),l("mi",null,"t"),l("mo",{stretchy:"false"},"("),l("mi",null,"x"),l("mo",{stretchy:"false"},")"),l("mo",{separator:"true"},","),l("mi",null,"m"),l("mo",null,"="),l("mi",null,"D"),l("mi",null,"i"),l("mi",null,"s"),l("mi",null,"p"),l("mi",null,"a"),l("mi",null,"t"),l("mi",null,"c"),l("mi",null,"h"),l("mo",{stretchy:"false"},"("),l("msub",null,[l("mi",null,"o"),l("mi",null,"i")]),l("mo",{separator:"true"},","),l("mi",null,"k"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"o_i\\in pt(x), m=Dispatch(o_i, k)")])])]),l("br"),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"o"),l("mi",null,"u")]),l("mo",null,"∈"),l("mi",null,"p"),l("mi",null,"t"),l("mo",{stretchy:"false"},"("),l("msub",null,[l("mi",null,"a"),l("mi",null,"j")]),l("mo",{stretchy:"false"},")"),l("mo",{separator:"true"},","),l("mn",null,"1"),l("mo",null,"≤"),l("mi",null,"j"),l("mo",null,"≤"),l("mi",null,"n")]),l("annotation",{encoding:"application/x-tex"},"o_u\\in pt(a_j), 1\\le j\\le n")])])]),l("br"),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"o"),l("mi",null,"v")]),l("mo",null,"∈"),l("mi",null,"p"),l("mi",null,"t"),l("mo",{stretchy:"false"},"("),l("msub",null,[l("mi",null,"m"),l("mrow",null,[l("mi",null,"r"),l("mi",null,"e"),l("mi",null,"t")])]),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"o_v\\in pt(m_{ret})")])])]),l("br"),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mover",{accent:"true"},[l("mrow",null,[l("msub",null,[l("mi",null,"o"),l("mi",null,"i")]),l("mo",null,"∈"),l("mi",null,"p"),l("mi",null,"t"),l("mo",{stretchy:"false"},"("),l("msub",null,[l("mi",null,"m"),l("mrow",null,[l("mi",null,"t"),l("mi",null,"h"),l("mi",null,"i"),l("mi",null,"s")])]),l("mo",{stretchy:"false"},")")]),l("mo",{stretchy:"true"},"‾")])]),l("annotation",{encoding:"application/x-tex"},"\\overline{o_i\\in pt(m_{this})}")])])]),l("br"),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"o"),l("mi",null,"u")]),l("mo",null,"∈"),l("mi",null,"p"),l("mi",null,"t"),l("mo",{stretchy:"false"},"("),l("msub",null,[l("mi",null,"m"),l("msub",null,[l("mi",null,"p"),l("mi",null,"j")])]),l("mo",{stretchy:"false"},")"),l("mo",{separator:"true"},","),l("mn",null,"1"),l("mo",null,"≤"),l("mi",null,"j"),l("mo",null,"≤"),l("mi",null,"n")]),l("annotation",{encoding:"application/x-tex"},"o_u\\in pt(m_{p_j}), 1\\le j\\le n")])])]),l("br"),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"o"),l("mi",null,"v")]),l("mo",null,"∈"),l("mi",null,"p"),l("mi",null,"t"),l("mo",{stretchy:"false"},"("),l("mi",null,"r"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"o_v\\in pt(r)")])])])]),l("td",{style:{"text-align":"center"}},[l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"a"),l("mn",null,"1")]),l("mo",null,"→"),l("msub",null,[l("mi",null,"m"),l("msub",null,[l("mi",null,"p"),l("mn",null,"1")])])]),l("annotation",{encoding:"application/x-tex"},"a_1\\to m_{p_1}")])])]),l("br"),n("… …"),l("br"),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"a"),l("mi",null,"n")]),l("mo",null,"→"),l("msub",null,[l("mi",null,"m"),l("msub",null,[l("mi",null,"p"),l("mi",null,"n")])])]),l("annotation",{encoding:"application/x-tex"},"a_n\\to m_{p_n}")])])]),l("br"),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"m"),l("mrow",null,[l("mi",null,"r"),l("mi",null,"e"),l("mi",null,"t")])]),l("mo",null,"→"),l("mi",null,"r")]),l("annotation",{encoding:"application/x-tex"},"m_{ret}\\to r")])])])])])])],-1),l("p",null,"其中，",-1),l("ul",null,[l("li",null,[l("p",null,[l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"D"),l("mi",null,"i"),l("mi",null,"s"),l("mi",null,"p"),l("mi",null,"a"),l("mi",null,"t"),l("mi",null,"c"),l("mi",null,"h"),l("mo",{stretchy:"false"},"("),l("msub",null,[l("mi",null,"o"),l("mi",null,"i")]),l("mo",{separator:"true"},","),l("mi",null,"k"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"Dispatch(o_i, k)")])])]),n(" 是根据对象 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"o"),l("mi",null,"i")])]),l("annotation",{encoding:"application/x-tex"},"o_i")])])]),n(" 的类型来做虚方法 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"k")]),l("annotation",{encoding:"application/x-tex"},"k")])])]),n(" 的派发（详见算法5.1），从而准确的找到对象 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"o"),l("mi",null,"i")])]),l("annotation",{encoding:"application/x-tex"},"o_i")])])]),n(" 对应的目标方法。这个方法派发是绝对精确的，因为Dispatch算法是对运行时的模拟。这里影响精度的因素只会是变量 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"x")]),l("annotation",{encoding:"application/x-tex"},"x")])])]),n(" 的指向集合内可能有不止一个指向对象。")])]),l("li",null,[l("p",null,[l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"m"),l("mrow",null,[l("mi",null,"t"),l("mi",null,"h"),l("mi",null,"i"),l("mi",null,"s")])])]),l("annotation",{encoding:"application/x-tex"},"m_{this}")])])]),n(" 是 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"m")]),l("annotation",{encoding:"application/x-tex"},"m")])])]),n(" 方法对应的 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"t"),l("mi",null,"h"),l("mi",null,"i"),l("mi",null,"s")]),l("annotation",{encoding:"application/x-tex"},"this")])])]),n(" 变量；")])]),l("li",null,[l("p",null,[l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"m"),l("msub",null,[l("mi",null,"p"),l("mi",null,"j")])])]),l("annotation",{encoding:"application/x-tex"},"m_{p_j}")])])]),n(" 是 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"m")]),l("annotation",{encoding:"application/x-tex"},"m")])])]),n(" 方法的第 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"j")]),l("annotation",{encoding:"application/x-tex"},"j")])])]),n(" 个形参；")])]),l("li",null,[l("p",null,[l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"m"),l("mrow",null,[l("mi",null,"r"),l("mi",null,"e"),l("mi",null,"t")])])]),l("annotation",{encoding:"application/x-tex"},"m_{ret}")])])]),n(" 是存放 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"m")]),l("annotation",{encoding:"application/x-tex"},"m")])])]),n(" 方法返回值的变量。")])])],-1),l("p",null,[n("比如说下面的例子：我们会建立3条PFG边，并且将 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"o"),l("mi",null,"i")])]),l("annotation",{encoding:"application/x-tex"},"o_i")])])]),n(" 赋给 "),l("code",null,"this"),n(" 。")],-1),l("p",{style:{"text-align":"center"}},[l("img",{src:L,alt:"call-rule",style:{zoom:"30%"}})],-1),l("p",null,[n("这里需要再解释一下的问题是，我们为什么不添加 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"x"),l("mo",null,"→"),l("mi",null,"t"),l("mi",null,"h"),l("mi",null,"i"),l("mi",null,"s")]),l("annotation",{encoding:"application/x-tex"},"x\\to this")])])]),n(" 作为一条 PFG 边？")],-1),l("p",null,[n("接收对象（Receiver Object）只应当流到对应目标方法的 "),l("code",null,"this"),n(" 变量中。比如说，如果 "),l("code",null,"x"),n(" 的指向集合里面有 T 类型的 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"o"),l("mi",null,"i")])]),l("annotation",{encoding:"application/x-tex"},"o_i")])])]),n(" ，以及 C 类型的 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"o"),l("mi",null,"j")])]),l("annotation",{encoding:"application/x-tex"},"o_j")])])]),n(" ，那么我们处理调用的时候，应当把 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"o"),l("mi",null,"i")])]),l("annotation",{encoding:"application/x-tex"},"o_i")])])]),n(" 赋给T类中的 "),l("code",null,"foo"),n(" 方法的 "),l("code",null,"this"),n(" 变量，把 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"o"),l("mi",null,"j")])]),l("annotation",{encoding:"application/x-tex"},"o_j")])])]),n(" 赋给 C 类中的 "),l("code",null,"foo"),n(" 方法的 "),l("code",null,"this"),n(" 变量。")],-1),l("p",null,[n("如果我们在 "),l("code",null,"x"),n(" 和 "),l("code",null,"this"),n(" 之间建立了 "),l("code",null,"PFG"),n(" 边，那么 "),l("code",null,"x"),n(" 指向集中的所有对象都会流到 "),l("code",null,"this"),n(" 中，这会导致一个父类的对象流到子类的方法中，或者子类的对象流到父类的方法中（假设子类中存在目标实例方法），这是错误的，为 "),l("code",null,"this"),n(" 变量增加了虚假的指向关系，因此我们不添加 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"x"),l("mo",null,"→"),l("mi",null,"t"),l("mi",null,"h"),l("mi",null,"i"),l("mi",null,"s")]),l("annotation",{encoding:"application/x-tex"},"x\\to this")])])]),n(" 作为PFG边。")],-1),l("h3",{id:"_7-4-3-过程间的指针分析思路",tabindex:"-1"},[n("7.4.3 过程间的指针分析思路 "),l("a",{class:"header-anchor",href:"#_7-4-3-过程间的指针分析思路","aria-label":'Permalink to "7.4.3 过程间的指针分析思路"'},"​")],-1),l("p",null,"过程间的指针分析是和调用图的构建一起进行的，也就是说，指针分析和调用图构建之间就像指针分析和指针流图构建之间一样，是相互依赖的。",-1),l("p",null,"调用图向我们描述了一个”可达的世界”：",-1),l("ul",null,[l("li",null,[l("p",null,[n("入口方法（比如说 "),l("code",null,"main"),n(" 方法）是一开始就可达的；")])]),l("li",null,[l("p",null,"其他的可达方法是在分析的过程中不断发现的；")]),l("li",null,[l("p",null,"只有可达的方法和语句才会被分析。")])],-1),l("div",{class:"definition"},[l("p",{class:"title"},"定义7.8"),l("p",null,[n("称调用图中，"),l("strong",null,[n("入口方法（Entry Methods）"),l("strong",null,"以及从入口方法可达的其他结点为"),n("可达方法（Reachable Methods）")]),n("。所有的可达方法构成了一个"),l("strong",null,"可达调用子图（Reachable Sub-Call-Graph）"),n("。")])],-1),l("p",null,"其实我们平时所说的调用图，指的就是可达调用子图，对于控制流无法到达的其他方法，我们并不关心，也不必去分析。比如说我使用了一些库方法，这个库的类中有许许多多的方法，而我们不需要分析整个库，只需要分析我们的控制流可达的方法即可。",-1),l("p",null,[n("比如说下面这个例子， "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"m"),l("mn",null,"6")]),l("mo",{separator:"true"},","),l("msub",null,[l("mi",null,"m"),l("mn",null,"7")]),l("mo",{separator:"true"},","),l("msub",null,[l("mi",null,"m"),l("mn",null,"8")]),l("mo",{separator:"true"},","),l("msub",null,[l("mi",null,"m"),l("mn",null,"9")])]),l("annotation",{encoding:"application/x-tex"},"m_6, m_7, m_8, m_9")])])]),n(" 就是不可达的方法，哪怕它们之间还有一些调用边之类的，我们也不关心了，因为程序的控制流不会经过那些边。")],-1),l("p",{style:{"text-align":"center"}},[l("img",{src:P,alt:"reachable",style:{zoom:"30%"}})],-1),l("h3",{id:"_7-4-4-算法",tabindex:"-1"},[n("7.4.4 算法 "),l("a",{class:"header-anchor",href:"#_7-4-4-算法","aria-label":'Permalink to "7.4.4 算法"'},"​")],-1),l("h4",{id:"算法内容",tabindex:"-1"},[n("算法内容 "),l("a",{class:"header-anchor",href:"#算法内容","aria-label":'Permalink to "算法内容"'},"​")],-1),l("div",{class:"algorithm"},[l("p",{class:"title"},"算法7.2 过程间上下文不敏感的全程序指针分析算法"),l("iframe",{src:"/posts/StaticAnalytics/07-pta-fd/inter-pta.html",frameborder:"no",border:"0",marginwidth:"0",width:"100%",height:"1230px",marginheight:"0",scrolling:"auto",style:{"box-shadow":"none"}}),l("p",null,[n("其中， "),l("code",null,"Propagate"),n(" 和 "),l("code",null,"AddEdge"),n(" 子过程同算法7.1，"),l("code",null,"Dispatch"),n(" 过程见算法5.1。")])],-1),l("h4",{id:"算法分析",tabindex:"-1"},[n("算法分析 "),l("a",{class:"header-anchor",href:"#算法分析","aria-label":'Permalink to "算法分析"'},"​")],-1),l("p",null,[n("算法第 27 - 41 行的 "),l("code",null,"AddReachable(m)"),n(" 子过程是的作用是拓展可达调用子图，分为两步：")],-1),l("ol",null,[l("li",null,[l("p",null,"添加新的可达的方法和语句（算法第 28 - 30 行）")]),l("li",null,[l("p",null,"为新发现的语句更新工作表和指针流图（算法第 31 - 39 行）")])],-1),l("p",null,"这个子过程会在两种情况下被调用：",-1),l("ul",null,[l("li",null,[l("p",null,"一开始的时候对入口方法调用（算法第8行）")]),l("li",null,[l("p",null,"当新的调用边被发现的时候对被发现的新方法调用（算法第 47 - 49 行）")])],-1),l("p",null,[n("这个算法中另一个新的子过程是算法 43 - 56 行的 "),l("code",null,"ProcessCall(x, o_i)"),n(" ，它的主要作用就是实现 7.4.2 中的调用规则，基本步骤为：")],-1),l("ol",null,[l("li",null,[l("p",null,"根据接收对象类型以及调用点处的方法签名作方法派发（第 44 - 45 行）")]),l("li",null,[l("p",null,[n("为目标方法的 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"t"),l("mi",null,"h"),l("mi",null,"i"),l("mi",null,"s")]),l("annotation",{encoding:"application/x-tex"},"this")])])]),n(" 变量添加新的指向关系（第 46 行）")])]),l("li",null,[l("p",null,"对新发现的目标方法即时（on-the-fly）构建调用图（第 47 - 49 行）")]),l("li",null,[l("p",null,"为新发现的目标方法建立传递参数和返回值的 PFG 边（第 50 - 53 行）")])],-1),l("h4",{id:"实例",tabindex:"-1"},[n("实例 "),l("a",{class:"header-anchor",href:"#实例","aria-label":'Permalink to "实例"'},"​")],-1),l("p",null,"比如说，对于下面的一段程序：",-1),l("div",{class:"language-java vp-adaptive-theme"},[l("button",{title:"Copy Code",class:"copy"}),l("span",{class:"lang"},"java"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"class"),l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," A"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),n(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    static"),l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," main"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),n(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        A a "),l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," A"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),n(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        A b "),l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," B"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),n(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        A c "),l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," b."),l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"foo"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(a);")]),n(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),n(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    A "),l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"foo"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(A "),l("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"x"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {...}")]),n(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),n(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"class"),l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," B"),l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," extends"),l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," A"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),n(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    A "),l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"foo"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(A "),l("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"y"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),n(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        A r "),l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," A"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),n(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," r;")]),n(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),n(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),l("button",{class:"collapse"})],-1),l("p",null,"运行算法7.2，我们可以得到如下的结果（读者可以自行尝试在纸上手动算一遍这个算法，能够加深印象）：",-1),l("p",{style:{"text-align":"center"}},[l("img",{src:v,alt:"pta-inter-alg-eg",style:{zoom:"30%"}})],-1),l("h2",{id:"_7-5-自检问题",tabindex:"-1"},[n("7.5 自检问题 "),l("a",{class:"header-anchor",href:"#_7-5-自检问题","aria-label":'Permalink to "7.5 自检问题"'},"​")],-1),l("ol",null,[l("li",null,[l("p",null,"指针分析的规则（Pointer Analysis Rules）是什么？")]),l("li",null,[l("p",null,"如何理解指针流图（Pointer Flow Graph）？")]),l("li",null,[l("p",null,"指针分析算法（Pointer Analysis Algorithms）的基本过程是什么？")]),l("li",null,[l("p",null,"如何理解方法调用（Method Call）中指针分析的规则？")]),l("li",null,[l("p",null,"怎样理解过程间的指针分析算法（Inter-procedural Pointer Analysis Algorithm）？")]),l("li",null,[l("p",null,"即时调用图构建（On-the-fly Call Graph Construction）的含义是什么？")])],-1),l("div",{class:"tip custom-block"},[l("p",{class:"custom-block-title"},[l("span",{lang:"en"},"作业布置"),l("span",{lang:"zh-CN"},"作业布置")]),l("p",null,[n("到此为止，读者已经具备了完成"),l("a",{href:"https://tai-e.pascal-lab.net/pa5.html",target:"_blank",rel:"noreferrer"},"作业 5：非上下文敏感指针分析"),n("所需的全部理论知识。")])],-1)])),"main-header":t(()=>[i(a.$slots,"main-header")]),"main-header-after":t(()=>[i(a.$slots,"main-header-after")]),"main-nav":t(()=>[i(a.$slots,"main-nav")]),"main-content":t(()=>[i(a.$slots,"main-content")]),"main-content-after":t(()=>[i(a.$slots,"main-content-after")]),"main-nav-before":t(()=>[i(a.$slots,"main-nav-before")]),"main-nav-after":t(()=>[i(a.$slots,"main-nav-after")]),comment:t(()=>[i(a.$slots,"comment")]),footer:t(()=>[i(a.$slots,"footer")]),aside:t(()=>[i(a.$slots,"aside")]),"aside-custom":t(()=>[i(a.$slots,"aside-custom")]),default:t(()=>[i(a.$slots,"default")]),_:3},8,["frontmatter"])}}};export{V as default};

import{_ as r}from"./ValaxyMain.vue_vue_type_style_index_0_lang-Bn109ln0.js";import{c,w as a,f as w,a as x,p as u,o as M,g as l,h as n,r as i}from"./app-DvGICojQ.js";import"./YunFooter.vue_vue_type_style_index_0_lang-6I6EwKPx.js";import"./YunCard.vue_vue_type_script_setup_true_lang-G2SLBOpE.js";import"./index-C5okkQwF.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang-B-GmT0Fn.js";import"./post-JeTKiWMk.js";const g="/assets/false-positive-xVy-8_8R.jpg",d="/assets/false-negative-BVRtGgo6.jpg",F={__name:"20240729 1 静态分析概述",setup(k,{expose:p}){const s=JSON.parse('{"title":"1 静态分析概述","description":"","frontmatter":{"title":"1 静态分析概述","date":"2024-07-29T00:00:00.000Z","tags":["静态代码分析","概述","入门学习"],"categories":["静态代码分析"]},"headers":[{"level":2,"title":"1.1 静态分析的基本概念","slug":"_1-1-静态分析的基本概念","link":"#_1-1-静态分析的基本概念","children":[]},{"level":2,"title":"1.2 静态分析的类型","slug":"_1-2-静态分析的类型","link":"#_1-2-静态分析的类型","children":[{"level":3,"title":"1.2.1 完美的静态分析","slug":"_1-2-1-完美的静态分析","link":"#_1-2-1-完美的静态分析","children":[]},{"level":3,"title":"1.2.2 妥协的静态分析","slug":"_1-2-2-妥协的静态分析","link":"#_1-2-2-妥协的静态分析","children":[]},{"level":3,"title":"1.2.3 现实世界中有用的静态分析","slug":"_1-2-3-现实世界中有用的静态分析","link":"#_1-2-3-现实世界中有用的静态分析","children":[]}]},{"level":2,"title":"1.3 抽象","slug":"_1-3-抽象","link":"#_1-3-抽象","children":[{"level":3,"title":"1.3.1 抽象的概念","slug":"_1-3-1-抽象的概念","link":"#_1-3-1-抽象的概念","children":[]},{"level":3,"title":"1.3.2 一个静态分析的例子","slug":"_1-3-2-一个静态分析的例子","link":"#_1-3-2-一个静态分析的例子","children":[]},{"level":3,"title":"1.3.3 Sound 的分析和过近似","slug":"_1-3-3-sound-的分析和过近似","link":"#_1-3-3-sound-的分析和过近似","children":[]}]},{"level":2,"title":"1.4 自检问题","slug":"_1-4-自检问题","link":"#_1-4-自检问题","children":[]},{"level":2,"title":"个人感悟","slug":"个人感悟","link":"#个人感悟","children":[]}],"relativePath":"pages/posts/静态代码分析/20240729 1 静态分析概述/20240729 1 静态分析概述.md","path":"/home/runner/work/LiuZhuJunYa.github.io/LiuZhuJunYa.github.io/pages/posts/静态代码分析/20240729 1 静态分析概述/20240729 1 静态分析概述.md","lastUpdated":1731428437000}'),m=x(),o=s.frontmatter||{};return m.meta.frontmatter=Object.assign(m.meta.frontmatter||{},s.frontmatter||{}),u("pageData",s),u("valaxy:frontmatter",o),globalThis.$frontmatter=o,p({frontmatter:{title:"1 静态分析概述",date:"2024-07-29T00:00:00.000Z",tags:["静态代码分析","概述","入门学习"],categories:["静态代码分析"]}}),(t,e)=>{const h=r;return M(),c(h,{frontmatter:w(o)},{"main-content-md":a(()=>e[0]||(e[0]=[l("p",null,[n("原文链接："),l("a",{href:"https://static-analysis.cuijiacai.com/01-intro/",target:"_blank",rel:"noreferrer"},"https://static-analysis.cuijiacai.com/01-intro/")],-1),l("h1",{id:"_1-静态分析概述",tabindex:"-1"},[n("1 静态分析概述 "),l("a",{class:"header-anchor",href:"#_1-静态分析概述","aria-label":'Permalink to "1 静态分析概述"'},"​")],-1),l("iframe",{src:"//player.bilibili.com/player.html?aid=913873425&bvid=BV16M4y1p7Sh&cid=1204582427&page=1",scrolling:"no",border:"0",frameborder:"no",framespacing:"0",allowfullscreen:"true",width:"100%",height:"400px"},null,-1),l("h2",{id:"_1-1-静态分析的基本概念",tabindex:"-1"},[n("1.1 静态分析的基本概念 "),l("a",{class:"header-anchor",href:"#_1-1-静态分析的基本概念","aria-label":'Permalink to "1.1 静态分析的基本概念"'},"​")],-1),l("div",{class:"definition"},[l("p",{class:"title"},"定义1.1"),l("p",null,[l("strong",null,"静态分析（Static Analysis）"),n(" 是指在实际运行程序 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P")]),l("annotation",{encoding:"application/x-tex"},"P")])])]),n(" 之前，通过分析静态程序 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P")]),l("annotation",{encoding:"application/x-tex"},"P")])])]),n(" 本身来推测程序的行为，并判断程序是否满足某些特定的 "),l("strong",null,"性质（Property）"),n(),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"Q")]),l("annotation",{encoding:"application/x-tex"},"Q")])])]),n(" 。")])],-1),l("p",null,"我们会关心的程序性质可能有：",-1),l("ul",null,[l("li",null,[l("p",null,"程序P是否会产生私有信息泄漏（Private Information Leak），或者说是否存在访问控制漏洞（Access Control Venerability）；")]),l("li",null,[l("p",null,"程序P是否有空指针的解引用(Null Pointer Dereference)操作，更一般的，是否会发生不可修复的运行时错误（Runtime Error）；")]),l("li",null,[l("p",null,"程序P中的类型转换（Type Cast）是否都是安全的；")]),l("li",null,[l("p",null,"程序P中是否存在可能无法满足的断言（Assersion Error）；")]),l("li",null,[l("p",null,"程序P中是否存在死代码（Dead Code, 即控制流在任何情况下都无法到达的代码）；")])],-1),l("p",null,"有些可惜的是，静态分析并不能对于我们上面关心的问题给出一个确切的答案。",-1),l("div",{class:"theorem"},[l("p",{class:"title"},"定理1.1 Rice定理（Rice Theorem）"),l("p",null,[n("对于使用 "),l("strong",null,"递归可枚举（Recursively Enumerable）"),n(" 的语言描述的程序，其任何 "),l("strong",null,"非平凡（Non-trivial）"),n(" 的性质都是无法完美确定的。")])],-1),l("p",null,"在这个定理中，有几个字眼需要我们稍微关注一下：",-1),l("ul",null,[l("li",null,[l("p",null,"关于递归可枚举，其含义是存在某个计算函数（可以是图灵机），能够将这种语言中的所有合法字符串枚举出来。这个概念有些抽象，不必深究，暂时只需要知道，目前我们所能想到的所有的编程语言都是递归可枚举语言。")]),l("li",null,[l("p",null,"关于非平凡，我们认为，如果一种性质是所有的程序都满足的或者都不满足的，那么这种性质就是平凡的，除此之外的性质都是非平凡的。其实和程序运行时的行为相关的，让我们感兴趣的性质，基本都是非平凡的性质。")])],-1),l("h2",{id:"_1-2-静态分析的类型",tabindex:"-1"},[n("1.2 静态分析的类型 "),l("a",{class:"header-anchor",href:"#_1-2-静态分析的类型","aria-label":'Permalink to "1.2 静态分析的类型"'},"​")],-1),l("h3",{id:"_1-2-1-完美的静态分析",tabindex:"-1"},[n("1.2.1 完美的静态分析 "),l("a",{class:"header-anchor",href:"#_1-2-1-完美的静态分析","aria-label":'Permalink to "1.2.1 完美的静态分析"'},"​")],-1),l("div",{class:"definition"},[l("p",{class:"title"},"定义1.2"),l("p",null,[n("如果一个静态分析 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"S")]),l("annotation",{encoding:"application/x-tex"},"S")])])]),n(" 能够对于程序 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P")]),l("annotation",{encoding:"application/x-tex"},"P")])])]),n(" 的某个非平凡性质 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"Q")]),l("annotation",{encoding:"application/x-tex"},"Q")])])]),n(" 给出确切的答案，我们就称 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"S")]),l("annotation",{encoding:"application/x-tex"},"S")])])]),n(" 是 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P")]),l("annotation",{encoding:"application/x-tex"},"P")])])]),n(" 关于 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"Q")]),l("annotation",{encoding:"application/x-tex"},"Q")])])]),n(" 的 "),l("strong",null,"完美静态分析（Perfect Static Analysis）"),n(" 。我们定义程序P的关于Q的真实行为为 "),l("strong",null,"真相（Truth）"),n(" ，那么完美静态分析有两层含义：")]),l("ul",null,[l("li",null,[l("p",null,[l("strong",null,"完全性（Soundness）"),n("：真相一定包含在 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"S")]),l("annotation",{encoding:"application/x-tex"},"S")])])]),n(" 给出的答案中；")])]),l("li",null,[l("p",null,[l("strong",null,"正确性（Completeness）"),n("："),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"S")]),l("annotation",{encoding:"application/x-tex"},"S")])])]),n(" 给出的答案一定包含在真相中；")])])]),l("p",null,[n("记这个静态分析程序给出的答案集合 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"A")]),l("annotation",{encoding:"application/x-tex"},"A")])])]),n(" ，真相集合为 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"T")]),l("annotation",{encoding:"application/x-tex"},"T")])])]),n(" ，则完美的静态分析满足：")]),l("p",null,[l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[l("semantics",null,[l("mrow",null,[l("mi",null,"T"),l("mo",null,"⊆"),l("mi",null,"A"),l("mo",null,"∧"),l("mi",null,"A"),l("mo",null,"⊆"),l("mi",null,"T"),l("mo",null,"⇔"),l("mi",null,"A"),l("mo",null,"="),l("mi",null,"T")]),l("annotation",{encoding:"application/x-tex"},"T \\subseteq A \\wedge A \\subseteq T \\Leftrightarrow A = T ")])])])]),l("p",null,[n("其中， "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"T"),l("mo",null,"⊆"),l("mi",null,"A")]),l("annotation",{encoding:"application/x-tex"},"T \\subseteq A")])])]),n(" 体现了完全性， "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"A"),l("mo",null,"⊆"),l("mi",null,"T")]),l("annotation",{encoding:"application/x-tex"},"A \\subseteq T")])])]),n(" 体现了正确性。")])],-1),l("p",null,"简单理解，一个完美的静态分析给出的答案应当既是对的，也是全的。",-1),l("p",null,"但是Rice定理告诉我们，不存在完美的静态分析，那么静态分析是否就没用了呢？并不是，有用和完美之间，往往是有着一片广阔的空间的。",-1),l("h3",{id:"_1-2-2-妥协的静态分析",tabindex:"-1"},[n("1.2.2 妥协的静态分析 "),l("a",{class:"header-anchor",href:"#_1-2-2-妥协的静态分析","aria-label":'Permalink to "1.2.2 妥协的静态分析"'},"​")],-1),l("p",null,[n("因为完美的静态分析并不存在，所以我们通常需要做一些妥协，也就是在 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"T"),l("mo",null,"⊆"),l("mi",null,"A")]),l("annotation",{encoding:"application/x-tex"},"T \\subseteq A")])])]),n(" 和 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"A"),l("mo",null,"⊆"),l("mi",null,"T")]),l("annotation",{encoding:"application/x-tex"},"A\\subseteq T")])])]),n(" 中只尽力满足其中一个条件，妥协另一个条件。")],-1),l("p",null,"于是，我们得到了两种妥协后的静态分析类型。",-1),l("div",{class:"definition"},[l("p",{class:"title"},"定义1.3"),l("p",null,[n("记程序 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P")]),l("annotation",{encoding:"application/x-tex"},"P")])])]),n(" 的关于性质 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"Q")]),l("annotation",{encoding:"application/x-tex"},"Q")])])]),n(" 的静态分析S为 "),l("strong",null,"Sound 的静态分析（Sound Static Analysis）"),n(" ，当且仅当 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"S")]),l("annotation",{encoding:"application/x-tex"},"S")])])]),n(" 给出的答案集合 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"A")]),l("annotation",{encoding:"application/x-tex"},"A")])])]),n(" 和 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P")]),l("annotation",{encoding:"application/x-tex"},"P")])])]),n(" 关于 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"Q")]),l("annotation",{encoding:"application/x-tex"},"Q")])])]),n(" 的真相集合 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"T")]),l("annotation",{encoding:"application/x-tex"},"T")])])]),n(" 之间满足 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"T"),l("mo",null,"⊆"),l("mi",null,"A")]),l("annotation",{encoding:"application/x-tex"},"T \\subseteq A")])])]),n(" ，这种分析策略也称作 "),l("strong",null,"过近似（Over-approximation）"),n(" 。")])],-1),l("div",{class:"definition"},[l("p",{class:"title"},"定义1.4"),l("p",null,[n("记程序 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P")]),l("annotation",{encoding:"application/x-tex"},"P")])])]),n(" 的关于性质 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"Q")]),l("annotation",{encoding:"application/x-tex"},"Q")])])]),n(" 的静态分析 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"S")]),l("annotation",{encoding:"application/x-tex"},"S")])])]),n(" 为 "),l("strong",null,"Complete 的静态分析（Complete Static Analysis）"),n(" ，当且仅当 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"S")]),l("annotation",{encoding:"application/x-tex"},"S")])])]),n(" 给出的答案集合 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"A")]),l("annotation",{encoding:"application/x-tex"},"A")])])]),n(" 和 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P")]),l("annotation",{encoding:"application/x-tex"},"P")])])]),n(" 关于 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"Q")]),l("annotation",{encoding:"application/x-tex"},"Q")])])]),n(" 的真相集合 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"T")]),l("annotation",{encoding:"application/x-tex"},"T")])])]),n(" 之间满足 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"A"),l("mo",null,"⊆"),l("mi",null,"T")]),l("annotation",{encoding:"application/x-tex"},"A \\subseteq T")])])]),n(" ，这种分析策略也称作 "),l("strong",null,"欠近似（Under-approximation）"),n(" 。")])],-1),l("p",null,"其中，",-1),l("ul",null,[l("li",null,"Sound 的静态分析保证了完全性，妥协了正确性，会过近似（Overapproximate）程序的行为，因此会出现假积极（False Positive）的现象，即判定为积极，但实际是消极的。反映在现实场景中即为误报问题。")],-1),l("p",{style:{"text-align":"center"}},[l("img",{src:g,alt:"false-positive",style:{zoom:"50%"}})],-1),l("blockquote",null,[l("p",null,[n("在继续推进之前，我们先解释一下积极和消极的含义，对于客观世界来说， "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"T")]),l("annotation",{encoding:"application/x-tex"},"T")])])]),n(" 是积极的， "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mover",{accent:"true"},[l("mi",null,"T"),l("mo",{stretchy:"true"},"‾")])]),l("annotation",{encoding:"application/x-tex"},"\\overline T")])])]),n(" 是消极的，从 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"S")]),l("annotation",{encoding:"application/x-tex"},"S")])])]),n(" 的视角来看， "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"A")]),l("annotation",{encoding:"application/x-tex"},"A")])])]),n(" 是积极的， "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mover",{accent:"true"},[l("mi",null,"A"),l("mo",{stretchy:"true"},"‾")])]),l("annotation",{encoding:"application/x-tex"},"\\overline A")])])]),n(" 是消极的。")]),l("p",null,[n("所谓假积极，就是 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"S")]),l("annotation",{encoding:"application/x-tex"},"S")])])]),n(" 认为的积极其实在客观世界中是消极。类似的，假消极也就可以理解了。")])],-1),l("p",null,"这里，借用之前的形式化语言，我们其实可以明确的定义出在静态分析中的 False Positive ：",-1),l("div",{class:"definition"},[l("p",{class:"title"},"定义1.5"),l("p",null,[n("记程序 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P")]),l("annotation",{encoding:"application/x-tex"},"P")])])]),n(" 的关于性质 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"Q")]),l("annotation",{encoding:"application/x-tex"},"Q")])])]),n(" 的静态分析S有 "),l("strong",null,"假积极（False Positive）"),n(" 问题，当且仅当 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"S")]),l("annotation",{encoding:"application/x-tex"},"S")])])]),n(" 给出的答案 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"A")]),l("annotation",{encoding:"application/x-tex"},"A")])])]),n(" 和 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P")]),l("annotation",{encoding:"application/x-tex"},"P")])])]),n(" 关于 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"Q")]),l("annotation",{encoding:"application/x-tex"},"Q")])])]),n(" 的真相T满足如下关系：")]),l("p",null,[l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[l("semantics",null,[l("mrow",null,[l("mi",{mathvariant:"normal"},"∃"),l("mi",null,"a"),l("mo",null,"∈"),l("mi",null,"A"),l("mo",{separator:"true"},","),l("mi",null,"a"),l("mo",{mathvariant:"normal"},"∉"),l("mi",null,"T")]),l("annotation",{encoding:"application/x-tex"},"\\exists a \\in A, a\\notin T ")])])])]),l("p",null,[n("其中， "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"a")]),l("annotation",{encoding:"application/x-tex"},"a")])])]),n(" 称为一个 "),l("strong",null,"假积极实例（False Positive Instance）"),n(" ，其实是一个 "),l("strong",null,"消极实例（Negative Instance）"),n(" 。")])],-1),l("ul",null,[l("li",null,[n("Complete 的静态分析保证了正确性，妥协了完全性，会欠近似（Underapproximate）程序的行为，因此会出现假消极（False Negative）现象，即判定为消极（在 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mover",{accent:"true"},[l("mi",null,"A"),l("mo",{stretchy:"true"},"‾")])]),l("annotation",{encoding:"application/x-tex"},"\\overline A")])])]),n(" 中），但实际是积极（在 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"T")]),l("annotation",{encoding:"application/x-tex"},"T")])])]),n(" 中）。反映在现实场景中即为漏报问题。")])],-1),l("p",{style:{"text-align":"center"}},[l("img",{src:d,alt:"false-negative",style:{zoom:"50%"}})],-1),l("p",null,"和定义1.5类似，我们可以形式化的定义出False Negative：",-1),l("div",{class:"definition"},[l("p",{class:"title"},"定义1.6"),l("p",null,[n("记程序 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P")]),l("annotation",{encoding:"application/x-tex"},"P")])])]),n(" 的关于性质 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"Q")]),l("annotation",{encoding:"application/x-tex"},"Q")])])]),n(" 的静态分析 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"S")]),l("annotation",{encoding:"application/x-tex"},"S")])])]),n(" 有 "),l("strong",null,"假消极（False Negative）"),n(" 问题，当且仅当 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"S")]),l("annotation",{encoding:"application/x-tex"},"S")])])]),n(" 给出的答案 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"A")]),l("annotation",{encoding:"application/x-tex"},"A")])])]),n(" 和 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P")]),l("annotation",{encoding:"application/x-tex"},"P")])])]),n(" 关于 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"Q")]),l("annotation",{encoding:"application/x-tex"},"Q")])])]),n(" 的真相 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"T")]),l("annotation",{encoding:"application/x-tex"},"T")])])]),n(" 满足如下关系：")]),l("p",null,[l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[l("semantics",null,[l("mrow",null,[l("mi",{mathvariant:"normal"},"∃"),l("mi",null,"a"),l("mo",{mathvariant:"normal"},"∉"),l("mi",null,"A"),l("mo",{separator:"true"},","),l("mi",null,"a"),l("mo",null,"∈"),l("mi",null,"T")]),l("annotation",{encoding:"application/x-tex"},"\\exists a \\notin A, a\\in T ")])])])]),l("p",null,[n("其中， "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"a")]),l("annotation",{encoding:"application/x-tex"},"a")])])]),n(" 称为一个 "),l("strong",null,"假消极实例（False Negative Instance）"),n(" ，其实是一个 "),l("strong",null,"积极实例（Positive Instance）"),n(" 。")])],-1),l("h3",{id:"_1-2-3-现实世界中有用的静态分析",tabindex:"-1"},[n("1.2.3 现实世界中有用的静态分析 "),l("a",{class:"header-anchor",href:"#_1-2-3-现实世界中有用的静态分析","aria-label":'Permalink to "1.2.3 现实世界中有用的静态分析"'},"​")],-1),l("p",null,"大多数的静态分析会妥协正确性，保证完全性，即 Sound 的静态分析居多，这样的静态分析虽然不是完美的，但是有用的。以 debug 为例，在实际的开发过程中，Sound 的静态分析可以帮助我们有效的缩小 debug 的范围，我们最多只需要暴力排查掉所有的假积极实例（False Positive Instance）就可以了。",-1),l("p",null,[n("由于假积极实例 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"a"),l("mo",null,"∈"),l("mi",null,"A")]),l("annotation",{encoding:"application/x-tex"},"a \\in A")])])]),n(" ，所以这个人工排查 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"a")]),l("annotation",{encoding:"application/x-tex"},"a")])])]),n(" 的代价仍然是可控的，假设暴力排查一个程序点是否为 bug 的平均代价是常数项时间，则排查假积极的代价在 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"O"),l("mo",{stretchy:"false"},"("),l("mi",{mathvariant:"normal"},"∣"),l("mi",null,"A"),l("mi",{mathvariant:"normal"},"∣"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"O(|A|)")])])]),n(" 以内。除非该 Sound 的分析极其不精确，导致 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",{mathvariant:"normal"},"∣"),l("mi",null,"A"),l("mi",{mathvariant:"normal"},"∣")]),l("annotation",{encoding:"application/x-tex"},"|A|")])])]),n(" 特别的大，否则 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"O"),l("mo",{stretchy:"false"},"("),l("mi",{mathvariant:"normal"},"∣"),l("mi",null,"A"),l("mi",{mathvariant:"normal"},"∣"),l("mo",{stretchy:"false"},")")]),l("annotation",{encoding:"application/x-tex"},"O(|A|)")])])]),n(" 是一个可以接受的代价，有一点错误的 Warning 问题不大。")],-1),l("p",null,[n("但是，Complete 的静态分析做不到这一点，它不能够帮助我们有效缩小 debug 的范围。因为假消极实例（False Negative Instance）"),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"a"),l("mo",{mathvariant:"normal"},"∉"),l("mi",null,"A")]),l("annotation",{encoding:"application/x-tex"},"a \\notin A")])])]),n(" ，所以 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"a")]),l("annotation",{encoding:"application/x-tex"},"a")])])]),n(" 的范围是 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P"),l("mo",null,"−"),l("mi",null,"A")]),l("annotation",{encoding:"application/x-tex"},"P - A")])])]),n(" 。这里注意的是，虽然假消极的理论范围是 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"T"),l("mo",null,"−"),l("mi",null,"A")]),l("annotation",{encoding:"application/x-tex"},"T - A")])])]),n(" ，但因为我们并不知道 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"T")]),l("annotation",{encoding:"application/x-tex"},"T")])])]),n(" 是什么，所以只能从 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P"),l("mo",null,"−"),l("mi",null,"A")]),l("annotation",{encoding:"application/x-tex"},"P - A")])])]),n(" 中排查。而 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P"),l("mo",null,"−"),l("mi",null,"A")]),l("annotation",{encoding:"application/x-tex"},"P - A")])])]),n(" 往往是比 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"A")]),l("annotation",{encoding:"application/x-tex"},"A")])])]),n(" 大得多的，因此排查假消极的代价是很大的。")],-1),l("p",null,[n("除非存在某个 Complete 的静态分析 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"S")]),l("annotation",{encoding:"application/x-tex"},"S")])])]),n(" ，能够做到 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"A")]),l("annotation",{encoding:"application/x-tex"},"A")])])]),n(" 接近于 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P")]),l("annotation",{encoding:"application/x-tex"},"P")])])]),n(" （这里的 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P")]),l("annotation",{encoding:"application/x-tex"},"P")])])]),n(" 理解为整个程序的全集），这样 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P"),l("mo",null,"−"),l("mi",null,"A")]),l("annotation",{encoding:"application/x-tex"},"P - A")])])]),n(" 会比较小，从而排查假消极的代价就小了。但是 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"A"),l("mo",null,"⊆"),l("mi",null,"T"),l("mo",null,"⊆"),l("mi",null,"P")]),l("annotation",{encoding:"application/x-tex"},"A \\subseteq T \\subseteq P")])])]),n(" ，如果要做到让 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"A")]),l("annotation",{encoding:"application/x-tex"},"A")])])]),n(" 接近于 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P")]),l("annotation",{encoding:"application/x-tex"},"P")])])]),n(" ，我们就需要一个 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"T")]),l("annotation",{encoding:"application/x-tex"},"T")])])]),n(" 接近于 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P")]),l("annotation",{encoding:"application/x-tex"},"P")])])]),n(" 的前提条件，因为 Complete 分析下 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"A")]),l("annotation",{encoding:"application/x-tex"},"A")])])]),n(" 不会超过 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"T")]),l("annotation",{encoding:"application/x-tex"},"T")])])]),n(" 。")],-1),l("p",null,[n("换言之，为了让排除假消极变得容易，需要程序 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P")]),l("annotation",{encoding:"application/x-tex"},"P")])])]),n(" 本身就十分符合性质 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"Q")]),l("annotation",{encoding:"application/x-tex"},"Q")])])]),n(" 。但是，如果静态分析 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"S")]),l("annotation",{encoding:"application/x-tex"},"S")])])]),n(" 对于程序 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P")]),l("annotation",{encoding:"application/x-tex"},"P")])])]),n(" 本身提出了 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P")]),l("annotation",{encoding:"application/x-tex"},"P")])])]),n(" 接近于 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"T")]),l("annotation",{encoding:"application/x-tex"},"T")])])]),n(" 的要求，那么我们还要静态分析干嘛呢？")],-1),l("p",null,[n("我们使用静态分析的原因就是我们做不到写出非常符合 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"Q")]),l("annotation",{encoding:"application/x-tex"},"Q")])])]),n(" 的 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P")]),l("annotation",{encoding:"application/x-tex"},"P")])])]),n(" （如果 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"Q")]),l("annotation",{encoding:"application/x-tex"},"Q")])])]),n(" 是一个优良的性质）或者我们根本不会去分析非常符合 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"Q")]),l("annotation",{encoding:"application/x-tex"},"Q")])])]),n(" 的 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P")]),l("annotation",{encoding:"application/x-tex"},"P")])])]),n(" （如果 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"Q")]),l("annotation",{encoding:"application/x-tex"},"Q")])])]),n(" 是一个糟糕的性质，那么非常符合 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"Q")]),l("annotation",{encoding:"application/x-tex"},"Q")])])]),n(" 的 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P")]),l("annotation",{encoding:"application/x-tex"},"P")])])]),n(" 就是一个非常糟糕的程序，我们需要分析的往往是普通的程序），也就是 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P")]),l("annotation",{encoding:"application/x-tex"},"P")])])]),n(" 本身达不到我们的期待，所以才需要静态分析来帮助改进 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P")]),l("annotation",{encoding:"application/x-tex"},"P")])])]),n(" 。")],-1),l("blockquote",null,[l("p",null,"上面一段逻辑分析好像有点绕，不知道读者能不能理解逻辑（含义应该是好理解的，只是逻辑有点绕）。")],-1),l("p",null,"下面我们再看一个 Sound 的静态分析的例子：",-1),l("div",{class:"language-bash vp-adaptive-theme"},[l("button",{title:"Copy Code",class:"copy"}),l("span",{class:"lang"},"bash"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"if"),l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," input"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," then")]),n(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    x"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),n(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"else")]),n(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    x"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),n(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"output"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," x"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")])])]),l("button",{class:"collapse"})],-1),l("p",null,"我们可以有两种 Sound 的静态分析：",-1),l("ul",null,[l("li",null,[l("p",null,[n("当 "),l("code",null,"input"),n(" 为 "),l("code",null,"true"),n(" ，"),l("code",null,"x"),n(" 为 "),l("code",null,"1"),n(" ，当 "),l("code",null,"input"),n(" 为 "),l("code",null,"false"),n(" ， "),l("code",null,"x"),n(" 为 "),l("code",null,"0"),n(" ；")])]),l("li",null,[l("p",null,[l("code",null,"x"),n(" 为 "),l("code",null,"0"),n(" 或 "),l("code",null,"1")])])],-1),l("p",null,"这两种都保证了完全性，不过前者更精确，代价也更高；后者不那么精确，但相应的，代价也会更低一点。我们需要根据实际情况选择使用哪一种，也就是说在精度和速度之间做一个权衡。",-1),l("p",null,"基于上述所有的内容，我们可以对现实世界（Real World）中的静态分析做一个总结：",-1),l("div",{class:"conclusion"},[l("p",{class:"title"},"结论1.1"),l("p",null,[l("strong",null,"现实中的静态分析（Real-World Static Analysis）"),n(" 需要保证（或者尽可能保证）"),l("strong",null,"完全性（Soundness）"),n(" ，并在 "),l("strong",null,"速度（Speed）"),n(" 和 "),l("strong",null,"精度（Precision）"),n(" 之间做出一个合适的 "),l("strong",null,"权衡（Trade-off）"),n(" 。")])],-1),l("h2",{id:"_1-3-抽象",tabindex:"-1"},[n("1.3 抽象 "),l("a",{class:"header-anchor",href:"#_1-3-抽象","aria-label":'Permalink to "1.3 抽象"'},"​")],-1),l("div",{class:"conclusion"},[l("p",{class:"title"},"结论1.2"),l("p",null,[n("如果用两个词概括静态分析，可以是 "),l("strong",null,"抽象（Abstraction）"),n(" 和 "),l("strong",null,"过近似（Overapproximation）"),n(" 。")])],-1),l("p",null,[n("其中，过近似已经阐释的很清楚了（一个式子总结就是 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"T"),l("mo",null,"⊆"),l("mi",null,"A")]),l("annotation",{encoding:"application/x-tex"},"T \\subseteq A")])])]),n(" ），下面我们来看一下抽象。")],-1),l("h3",{id:"_1-3-1-抽象的概念",tabindex:"-1"},[n("1.3.1 抽象的概念 "),l("a",{class:"header-anchor",href:"#_1-3-1-抽象的概念","aria-label":'Permalink to "1.3.1 抽象的概念"'},"​")],-1),l("p",null,[n("当我们考虑程序P的性质 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"Q")]),l("annotation",{encoding:"application/x-tex"},"Q")])])]),n(" 时，程序 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P")]),l("annotation",{encoding:"application/x-tex"},"P")])])]),n(" 中的各种值，我们或许不一定非得事无巨细。比如说，当我们考虑除零错误（Zero Division Error）的时候，对于某个值，我们只需要判定其是否为 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mn",null,"0")]),l("annotation",{encoding:"application/x-tex"},"0")])])]),n(" 即可，至于它具体是多大，我们其实不关心，因为它和我们要研究的性质 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"Q")]),l("annotation",{encoding:"application/x-tex"},"Q")])])]),n(" 没有直接关联。")],-1),l("p",null,[n("这种将 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P")]),l("annotation",{encoding:"application/x-tex"},"P")])])]),n(" 中的值的，和我们需要研究的性质 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"Q")]),l("annotation",{encoding:"application/x-tex"},"Q")])])]),n(" 相关的性质提取出来，从而忽略其他细节的过程，就是一个抽象的过程。我们可以将这个过程形式化的定义出来：")],-1),l("div",{class:"definition"},[l("p",{class:"title"},"定义1.7"),l("p",null,[n("对于程序 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P")]),l("annotation",{encoding:"application/x-tex"},"P")])])]),n(" 的某个 "),l("strong",null,"具体值集（Concrete Domain）"),n(),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"D"),l("mi",null,"C")])]),l("annotation",{encoding:"application/x-tex"},"D_C")])])]),n(" ，静态分析 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"S")]),l("annotation",{encoding:"application/x-tex"},"S")])])]),n(" 基于要研究的性质 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"Q")]),l("annotation",{encoding:"application/x-tex"},"Q")])])]),n(" 设计一个 "),l("strong",null,"抽象值集（Abstract Domain）"),n(),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"D"),l("mi",null,"A")])]),l("annotation",{encoding:"application/x-tex"},"D_A")])])]),n(" （一般 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",{mathvariant:"normal"},"∣"),l("msub",null,[l("mi",null,"D"),l("mi",null,"A")]),l("mi",{mathvariant:"normal"},"∣"),l("mo",null,"<"),l("mi",{mathvariant:"normal"},"∣"),l("msub",null,[l("mi",null,"D"),l("mi",null,"C")]),l("mi",{mathvariant:"normal"},"∣")]),l("annotation",{encoding:"application/x-tex"},"|D_A| < |D_C|")])])]),n(" ，因为这样的设计才有简化问题的意义），并建立映射关系 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"f"),l("mrow",null,[l("msub",null,[l("mi",null,"D"),l("mi",null,"C")]),l("mo",null,"→"),l("msub",null,[l("mi",null,"D"),l("mi",null,"A")])])])]),l("annotation",{encoding:"application/x-tex"},"f_{D_C \\to D_A}")])])]),n(" （ "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"f"),l("mn",null,"1")]),l("mo",null,"⊆"),l("msub",null,[l("mi",null,"D"),l("mi",null,"C")]),l("mo",null,"×"),l("msub",null,[l("mi",null,"D"),l("mi",null,"A")])]),l("annotation",{encoding:"application/x-tex"},"f_1 \\subseteq D_C \\times D_A")])])]),n(" ），这个过程称之为 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"S")]),l("annotation",{encoding:"application/x-tex"},"S")])])]),n(" 对 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P")]),l("annotation",{encoding:"application/x-tex"},"P")])])]),n(" 关于 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"Q")]),l("annotation",{encoding:"application/x-tex"},"Q")])])]),n(" 的 "),l("strong",null,"抽象（Abstraction）"),n(" 过程。")]),l("p",null,[n("其中， "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"D"),l("mi",null,"A")])]),l("annotation",{encoding:"application/x-tex"},"D_A")])])]),n(" 中通常有两个特殊的值： "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",{mathvariant:"normal"},"⊤")]),l("annotation",{encoding:"application/x-tex"},"\\top")])])]),n(" 表示 "),l("strong",null,"未确定（Unknown）"),n(" 值， "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",{mathvariant:"normal"},"⊥")]),l("annotation",{encoding:"application/x-tex"},"\\bot")])])]),n(" 表示 "),l("strong",null,"未定义（Undefined）"),n(" 值，即通常 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",{mathvariant:"normal"},"⊤"),l("mo",null,"∈"),l("msub",null,[l("mi",null,"D"),l("mi",null,"A")]),l("mo",null,"∧"),l("mi",{mathvariant:"normal"},"⊥"),l("mo",null,"∈"),l("msub",null,[l("mi",null,"D"),l("mi",null,"A")])]),l("annotation",{encoding:"application/x-tex"},"\\top \\in D_A \\wedge \\bot \\in D_A")])])]),n(" ，并且通常 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",{mathvariant:"normal"},"⊤")]),l("annotation",{encoding:"application/x-tex"},"\\top")])])]),n(" 和 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",{mathvariant:"normal"},"⊥")]),l("annotation",{encoding:"application/x-tex"},"\\bot")])])]),n(" 会是程序中的表达式的值，因此我们还需要定义基于 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"D"),l("mi",null,"A")])]),l("annotation",{encoding:"application/x-tex"},"D_A")])])]),n(" 的运算（定义1.8）来理解 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",{mathvariant:"normal"},"⊤")]),l("annotation",{encoding:"application/x-tex"},"\\top")])])]),n(" 和 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",{mathvariant:"normal"},"⊥")]),l("annotation",{encoding:"application/x-tex"},"\\bot")])])]),n(" 。")])],-1),l("p",null,[n("当我们定义了 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"D"),l("mi",null,"A")])]),l("annotation",{encoding:"application/x-tex"},"D_A")])])]),n(" 和 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"f"),l("mrow",null,[l("msub",null,[l("mi",null,"D"),l("mi",null,"C")]),l("mo",null,"→"),l("msub",null,[l("mi",null,"D"),l("mi",null,"A")])])])]),l("annotation",{encoding:"application/x-tex"},"f_{D_C\\to D_A}")])])]),n(" 之后，与 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"D"),l("mi",null,"C")])]),l("annotation",{encoding:"application/x-tex"},"D_C")])])]),n(" 有关的表达式的抽象值也应当能够随之确定，为此，我们还需要定义状态转移函数。")],-1),l("div",{class:"definition"},[l("p",{class:"title"},"定义1.8"),l("p",null,[n("基于定义1.7，记 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"f"),l("mn",null,"1")]),l("mo",null,"="),l("msub",null,[l("mi",null,"f"),l("mrow",null,[l("msub",null,[l("mi",null,"D"),l("mi",null,"C")]),l("mo",null,"→"),l("msub",null,[l("mi",null,"D"),l("mi",null,"A")])])])]),l("annotation",{encoding:"application/x-tex"},"f_1 = f_{D_C \\to D_A}")])])]),n(" 考虑程序 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"P")]),l("annotation",{encoding:"application/x-tex"},"P")])])]),n(" 关于 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"D"),l("mi",null,"C")])]),l("annotation",{encoding:"application/x-tex"},"D_C")])])]),n(" 的二元操作集 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"O"),l("mi",null,"p")]),l("annotation",{encoding:"application/x-tex"},"Op")])])]),n(" ，我们可以建立映射 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"f"),l("mn",null,"2")]),l("mo",null,"="),l("msub",null,[l("mi",null,"f"),l("mrow",null,[l("mi",null,"O"),l("mi",null,"p"),l("mo",null,"×"),l("msub",null,[l("mi",null,"D"),l("mi",null,"A")]),l("mo",null,"×"),l("msub",null,[l("mi",null,"D"),l("mi",null,"A")]),l("mo",null,"→"),l("msub",null,[l("mi",null,"D"),l("mi",null,"A")])])])]),l("annotation",{encoding:"application/x-tex"},"f_2 = f_{Op \\times D_A \\times D_A \\to D_A}")])])]),n(" （ "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"f"),l("mn",null,"2")]),l("mo",null,"⊆"),l("mi",null,"O"),l("mi",null,"p"),l("mo",null,"×"),l("msub",null,[l("mi",null,"D"),l("mi",null,"A")]),l("mo",null,"×"),l("msub",null,[l("mi",null,"D"),l("mi",null,"A")]),l("mo",null,"×"),l("msub",null,[l("mi",null,"D"),l("mi",null,"A")])]),l("annotation",{encoding:"application/x-tex"},"f_2 \\subseteq Op \\times D_A \\times D_A\\times D_A")])])]),n(" ），这样，我们就可以将所有 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"D"),l("mi",null,"c")])]),l("annotation",{encoding:"application/x-tex"},"D_c")])])]),n(" 相关的表达式的值通过 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"f"),l("mn",null,"2")]),l("mo",null,"∘"),l("msub",null,[l("mi",null,"f"),l("mn",null,"1")])]),l("annotation",{encoding:"application/x-tex"},"f_2 \\circ f_1")])])]),n(" 也映射到 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"D"),l("mi",null,"A")])]),l("annotation",{encoding:"application/x-tex"},"D_A")])])]),n("。其中 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"f"),l("mn",null,"1")])]),l("annotation",{encoding:"application/x-tex"},"f_1")])])]),n(" 称为 "),l("strong",null,"状态函数（State Function）"),n(" ， "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"f"),l("mn",null,"2")])]),l("annotation",{encoding:"application/x-tex"},"f_2")])])]),n(" 称为 "),l("strong",null,"转移函数（Transfer Function）"),n(" 。")]),l("p",null,[n("由此可见，状态函数定义了我们如何将具体值转化为抽象值，转移函数定义了我们如何基于抽象值去 "),l("strong",null,"解析（Evaluate）"),n(" 表达式。")])],-1),l("blockquote",null,[l("p",null,[n("这里需要额外说明一下的事，我们定义了 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"O"),l("mi",null,"p")]),l("annotation",{encoding:"application/x-tex"},"Op")])])]),n(" 为二元操作集，其原因是下一讲中，我们会学习 "),l("strong",null,"三地址码（Three-Address Code, 3AC）"),n(" ，从而我们能够发现二元操作集表达能力的完备性，因此这里可以将 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"O"),l("mi",null,"p")]),l("annotation",{encoding:"application/x-tex"},"Op")])])]),n(" 定义为二元操作。")])],-1),l("h3",{id:"_1-3-2-一个静态分析的例子",tabindex:"-1"},[n("1.3.2 一个静态分析的例子 "),l("a",{class:"header-anchor",href:"#_1-3-2-一个静态分析的例子","aria-label":'Permalink to "1.3.2 一个静态分析的例子"'},"​")],-1),l("p",null,[n("举一个例子，假如我们研究程序中变量的正负性，则我们可以设计 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"D"),l("mi",null,"A")]),l("mo",null,"="),l("mo",{stretchy:"false"},"{"),l("mo",null,"+"),l("mo",{separator:"true"},","),l("mo",null,"−"),l("mo",{separator:"true"},","),l("mn",null,"0"),l("mo",{separator:"true"},","),l("mi",{mathvariant:"normal"},"⊤"),l("mo",{separator:"true"},","),l("mi",{mathvariant:"normal"},"⊥"),l("mo",{stretchy:"false"},"}")]),l("annotation",{encoding:"application/x-tex"},"D_A = \\{+, -, 0, \\top, \\bot\\}")])])]),n(" ，定义 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"f"),l("mn",null,"1")]),l("mo",null,"="),l("msub",null,[l("mi",null,"f"),l("mrow",null,[l("msub",null,[l("mi",null,"D"),l("mi",null,"C")]),l("mo",null,"→"),l("msub",null,[l("mi",null,"D"),l("mi",null,"A")])])])]),l("annotation",{encoding:"application/x-tex"},"f_1 = f_{D_C\\to D_A}")])])]),n(" ：")],-1),l("p",null,[l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[l("semantics",null,[l("mrow",null,[l("mi",{mathvariant:"normal"},"∀"),l("mi",null,"x"),l("mo",null,"∈"),l("msub",null,[l("mi",null,"D"),l("mi",null,"C")]),l("mo",{separator:"true"},","),l("msub",null,[l("mi",null,"f"),l("mn",null,"1")]),l("mo",{stretchy:"false"},"("),l("mi",null,"x"),l("mo",{stretchy:"false"},")"),l("mo",null,"="),l("mrow",null,[l("mo",{fence:"true"},"{"),l("mtable",{rowspacing:"0.36em",columnalign:"left left",columnspacing:"1em"},[l("mtr",null,[l("mtd",null,[l("mstyle",{scriptlevel:"0",displaystyle:"false"},[l("mrow",null,[l("mo",null,"+"),l("mo",{separator:"true"},","),l("mi",null,"i"),l("mi",null,"f"),l("mtext",null," "),l("mi",null,"x"),l("mo",null,">"),l("mn",null,"0")])])])]),l("mtr",null,[l("mtd",null,[l("mstyle",{scriptlevel:"0",displaystyle:"false"},[l("mrow",null,[l("mn",null,"0"),l("mo",{separator:"true"},","),l("mi",null,"i"),l("mi",null,"f"),l("mtext",null," "),l("mi",null,"x"),l("mo",null,"="),l("mn",null,"0")])])])]),l("mtr",null,[l("mtd",null,[l("mstyle",{scriptlevel:"0",displaystyle:"false"},[l("mrow",null,[l("mo",null,"−"),l("mo",{separator:"true"},","),l("mi",null,"i"),l("mi",null,"f"),l("mtext",null," "),l("mi",null,"x"),l("mo",null,"<"),l("mn",null,"0")])])])])])])]),l("annotation",{encoding:"application/x-tex"},"\\forall x \\in D_C, f_1(x)= \\begin{cases} +, if\\ x > 0\\\\ 0, if\\ x = 0\\\\ -, if\\ x < 0\\\\ \\end{cases} ")])])])],-1),l("p",null,[n("再定义 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"f"),l("mn",null,"2")]),l("mo",null,"="),l("msub",null,[l("mi",null,"f"),l("mrow",null,[l("mi",null,"O"),l("mi",null,"p"),l("mo",null,"×"),l("msub",null,[l("mi",null,"D"),l("mi",null,"A")]),l("mo",null,"×"),l("msub",null,[l("mi",null,"D"),l("mi",null,"A")]),l("mo",null,"→"),l("msub",null,[l("mi",null,"D"),l("mi",null,"A")])])])]),l("annotation",{encoding:"application/x-tex"},"f_2 = f_{Op\\times D_A\\times D_A \\to D_A}")])])]),n(" 如下：")],-1),l("p",null,[l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[l("semantics",null,[l("mrow",null,[l("msub",null,[l("mi",null,"f"),l("mn",null,"2")]),l("mo",null,"="),l("mo",{stretchy:"false"},"{"),l("mo",{stretchy:"false"},"("),l("mo",null,"+"),l("mo",{separator:"true"},","),l("mo",null,"+"),l("mo",{separator:"true"},","),l("mo",null,"+"),l("mo",{separator:"true"},","),l("mo",null,"+"),l("mo",{stretchy:"false"},")"),l("mo",{separator:"true"},","),l("mo",{stretchy:"false"},"("),l("mo",null,"+"),l("mo",{separator:"true"},","),l("mo",null,"−"),l("mo",{separator:"true"},","),l("mo",null,"−"),l("mo",{separator:"true"},","),l("mo",null,"−"),l("mo",{stretchy:"false"},")"),l("mo",{separator:"true"},","),l("mo",{stretchy:"false"},"("),l("mo",null,"+"),l("mo",{separator:"true"},","),l("mo",null,"+"),l("mo",{separator:"true"},","),l("mo",null,"−"),l("mo",{separator:"true"},","),l("mi",{mathvariant:"normal"},"⊤"),l("mo",{stretchy:"false"},")"),l("mo",{separator:"true"},","),l("mo",{stretchy:"false"},"("),l("mo",null,"+"),l("mo",{separator:"true"},","),l("mn",null,"0"),l("mo",{separator:"true"},","),l("mn",null,"0"),l("mo",{separator:"true"},","),l("mn",null,"0"),l("mo",{stretchy:"false"},")"),l("mo",{separator:"true"},",")]),l("annotation",{encoding:"application/x-tex"},"f_2 = \\{(+, +, +, +), (+, -, -, -), (+, +, -, \\top), (+, 0, 0, 0), ")])])])],-1),l("p",null,[l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[l("semantics",null,[l("mrow",null,[l("mo",{stretchy:"false"},"("),l("mi",{mathvariant:"normal"},"/"),l("mo",{separator:"true"},","),l("mo",null,"+"),l("mo",{separator:"true"},","),l("mo",null,"+"),l("mo",{separator:"true"},","),l("mo",null,"+"),l("mo",{stretchy:"false"},")"),l("mo",{separator:"true"},","),l("mo",{stretchy:"false"},"("),l("mi",{mathvariant:"normal"},"/"),l("mo",{separator:"true"},","),l("mo",null,"−"),l("mo",{separator:"true"},","),l("mo",null,"−"),l("mo",{separator:"true"},","),l("mo",null,"+"),l("mo",{stretchy:"false"},")"),l("mo",{separator:"true"},","),l("mo",{stretchy:"false"},"("),l("mi",{mathvariant:"normal"},"/"),l("mo",{separator:"true"},","),l("mi",{mathvariant:"normal"},"⊤"),l("mo",{separator:"true"},","),l("mn",null,"0"),l("mo",{separator:"true"},","),l("mi",{mathvariant:"normal"},"⊥"),l("mo",{stretchy:"false"},")"),l("mo",{separator:"true"},","),l("mo",{stretchy:"false"},"("),l("mi",{mathvariant:"normal"},"/"),l("mo",{separator:"true"},","),l("mo",null,"+"),l("mo",{separator:"true"},","),l("mo",null,"−"),l("mo",{separator:"true"},","),l("mo",null,"−"),l("mo",{stretchy:"false"},")"),l("mo",{separator:"true"},","),l("mi",{mathvariant:"normal"},"."),l("mi",{mathvariant:"normal"},"."),l("mi",{mathvariant:"normal"},"."),l("mi",{mathvariant:"normal"},"."),l("mi",{mathvariant:"normal"},"."),l("mi",{mathvariant:"normal"},"."),l("mo",{stretchy:"false"},"}")]),l("annotation",{encoding:"application/x-tex"},"(/, +, +, +), (/, -, -, +), (/, \\top, 0, \\bot), (/, +, -, -), ......\\} ")])])])],-1),l("p",null,"基于此：",-1),l("ol",null,[l("li",null,[l("p",null,[n("如果我们分析出某个数组的下标为 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",{mathvariant:"normal"},"⊤")]),l("annotation",{encoding:"application/x-tex"},"\\top")])])]),n(" ，那么我们就可以过近似地（Overapproximately）认为这个地方很可能会发生数组越界错误（Index Out of Bound Exception）；")])]),l("li",null,[l("p",null,[n("如果我们分析出某个数组的下标为 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mo",null,"−")]),l("annotation",{encoding:"application/x-tex"},"-")])])]),n(" ，那么我们就可以欠近似地（Underapproximately）认为这个地方一定会发生数组越界错误（Index Out of Bound Exception）；")])]),l("li",null,[l("p",null,[n("如果我们分析出某个地方出现了值 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",{mathvariant:"normal"},"⊥")]),l("annotation",{encoding:"application/x-tex"},"\\bot")])])]),n(" ，我们可以欠近似地确认，这个地方一定会发生除 0 错误（Zero-Division Error）")])]),l("li",null,[l("p",null,[n("如果我们分析出某个地方的分母为 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",{mathvariant:"normal"},"⊤")]),l("annotation",{encoding:"application/x-tex"},"\\top")])])]),n(" ，那么我们也可以过近似地认为这个地方会发生除 0 错误。")])])],-1),l("p",null,"于是，我们发现，抽象确实能够帮助我们分析问题，得出一些结论。其中，我们能够直观的感受到：",-1),l("ul",null,[l("li",null,[l("p",null,[n("第2条和第3条结论是具有 "),l("strong",null,"正确性（Completeness）"),n(" 但不是完全的；")])]),l("li",null,[l("p",null,[n("第4条结论具有 "),l("strong",null,"完全性（Soundness）"),n(" 但并不一定是正确的；")])]),l("li",null,[l("p",null,"第1条结论既没有完全性，也没有正确性，但是，它能够囊括一部分的真相。")])],-1),l("p",null,"于是，上述的静态分析S总体上是妥协了正确性（因为基于1.2.3中尽可能完全的原则，最终我们的答案应该会取并集——过近似 Overapproximate），接近完全（Close To Soundness）（其实也没有达到完全）的一种静态分析。",-1),l("h3",{id:"_1-3-3-sound-的分析和过近似",tabindex:"-1"},[n("1.3.3 Sound 的分析和过近似 "),l("a",{class:"header-anchor",href:"#_1-3-3-sound-的分析和过近似","aria-label":'Permalink to "1.3.3 Sound 的分析和过近似"'},"​")],-1),l("p",null,"再看一个例子，体会一下 Sound 的，过近似的分析原则：",-1),l("div",{class:"language-bash vp-adaptive-theme"},[l("button",{title:"Copy Code",class:"copy"}),l("span",{class:"lang"},"bash"),l("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[l("code",{"v-pre":""},[l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"x"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),n(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"if"),l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," input"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," then")]),n(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    y"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 10"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),n(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"else")]),n(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    y"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),l("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -1"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),n(`
`),l("span",{class:"line"},[l("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"z"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," x"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," +"),l("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," y"),l("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")])])]),l("button",{class:"collapse"})],-1),l("p",null,[n("我们会发现，在进入 2-5 行的条件语句的时候， "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"y")]),l("annotation",{encoding:"application/x-tex"},"y")])])]),n(" 的值可能为 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mn",null,"10")]),l("annotation",{encoding:"application/x-tex"},"10")])])]),n(" ，也可能为 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mo",null,"−"),l("mn",null,"1")]),l("annotation",{encoding:"application/x-tex"},"-1")])])]),n(" ，于是，我们最终会认为y的抽象值为 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",{mathvariant:"normal"},"⊤")]),l("annotation",{encoding:"application/x-tex"},"\\top")])])]),n(" ，最终 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",null,"z")]),l("annotation",{encoding:"application/x-tex"},"z")])])]),n(" 的抽象值也就为 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",{mathvariant:"normal"},"⊤")]),l("annotation",{encoding:"application/x-tex"},"\\top")])])]),n(" ，这样，我们的分析就是尽可能全面的，虽然它并不精确。")],-1),l("h2",{id:"_1-4-自检问题",tabindex:"-1"},[n("1.4 自检问题 "),l("a",{class:"header-anchor",href:"#_1-4-自检问题","aria-label":'Permalink to "1.4 自检问题"'},"​")],-1),l("ol",null,[l("li",null,"静态分析（Static Analysis）和动态测试（Dynamic Testing）的区别是什么？")],-1),l("blockquote",null,[l("p",null,[l("strong",null,"静态分析（Static Analysis）"),n("：")]),l("ul",null,[l("li",null,"静态分析是在程序不执行的情况下，分析程序代码的属性和行为。它通过检查代码来发现潜在的错误和缺陷。"),l("li",null,"这种方法通常使用自动化工具，可以在编译时或开发阶段进行。"),l("li",null,"优点：可以在早期发现错误、覆盖所有代码路径（理论上）。"),l("li",null,"缺点：可能产生误报（False Positives），无法捕捉所有运行时行为。")]),l("p",null,[l("strong",null,"动态测试（Dynamic Testing）"),n("：")]),l("ul",null,[l("li",null,"动态测试是在程序执行时，对程序的行为进行测试和验证。它通过实际运行程序来检查代码的正确性和性能。"),l("li",null,"这种方法包括单元测试、集成测试、系统测试等。"),l("li",null,"优点：可以捕捉运行时行为、验证程序在特定输入下的输出。"),l("li",null,"缺点：需要实际运行程序，无法覆盖所有可能的执行路径（取决于测试用例）。")])],-1),l("ol",{start:"2"},[l("li",null,"完全性（Soundness）、正确性（Completeness）、假积极（False Positives）和假消极（False Negatives）分别是什么含义？")],-1),l("blockquote",null,[l("p",null,[l("strong",null,"完全性（Soundness）"),n("：")]),l("ul",null,[l("li",null,"如果分析结果中包含的所有错误都是实际可能发生的错误，则分析是完全的。"),l("li",null,"也就是说，完全的分析不会报告不存在的错误（没有误报）。")]),l("p",null,[l("strong",null,"正确性（Completeness）"),n("：")]),l("ul",null,[l("li",null,"如果所有实际可能发生的错误都包含在分析结果中，则分析是正确的。"),l("li",null,"也就是说，正确的分析不会遗漏任何实际可能发生的错误（没有漏报）。")]),l("p",null,[l("strong",null,"假积极（False Positives）"),n("：")]),l("ul",null,[l("li",null,"分析报告的错误实际上并不存在的情况。"),l("li",null,"也就是说，程序运行时不会出现这些错误，但分析工具却报告了它们。")]),l("p",null,[l("strong",null,"假消极（False Negatives）"),n("：")]),l("ul",null,[l("li",null,"分析未报告的实际存在的错误。"),l("li",null,"也就是说，程序运行时会出现这些错误，但分析工具没有检测到它们。")])],-1),l("ol",{start:"3"},[l("li",null,"为什么静态分析通常需要尽可能保证完全性？")],-1),l("blockquote",null,[l("p",null,"静态分析需要尽可能保证完全性（Soundness），因为："),l("ul",null,[l("li",null,[l("strong",null,"早期发现问题"),n("：静态分析在程序开发早期就能发现潜在问题，避免在运行时发现严重缺陷。")]),l("li",null,[l("strong",null,"避免误报"),n("：完全的分析可以减少误报，开发者不必浪费时间在不存在的错误上。")]),l("li",null,[l("strong",null,"安全性和可靠性"),n("：在安全关键和高可靠性要求的系统中，确保所有潜在错误都能被准确检测是至关重要的。")]),l("li",null,[l("strong",null,"自动化工具的信任度"),n("：保证完全性可以提高静态分析工具的可信度和有效性，使开发者更愿意依赖这些工具进行代码检查。")])])],-1),l("ol",{start:"4"},[l("li",null,"如何理解抽象（Abstraction）和过近似（Over-Approximation）？")],-1),l("blockquote",null,[l("p",null,[l("strong",null,"抽象（Abstraction）"),n("：")]),l("ul",null,[l("li",null,"抽象是在分析过程中忽略细节，只关注程序的某些关键属性或行为。通过抽象，可以简化分析过程，提高效率。"),l("li",null,"例如，将具体变量值抽象为某些属性（如正数、负数、零）来进行分析。")]),l("p",null,[l("strong",null,"过近似（Over-Approximation）"),n("：")]),l("ul",null,[l("li",null,"过近似是抽象的一种方法，通过假设最坏情况来确保所有潜在错误都被包含在内。过近似可以确保正确性（所有可能的错误都包括在内），但可能会导致误报（假积极）。"),l("li",null,[n("例如，在数组下标分析中，将不确定的下标值抽象为 "),l("span",{class:"katex"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mi",{mathvariant:"normal"},"⊤")]),l("annotation",{encoding:"application/x-tex"},"\\top")])])]),n("，意味着这个值可以是任何可能的值，从而包含了所有潜在的数组越界错误。")])]),l("p",null,[l("strong",null,"理解抽象和过近似的关系"),n("：")]),l("ul",null,[l("li",null,"抽象是分析的基础，通过简化和忽略不必要的细节，提高分析效率。"),l("li",null,"过近似是抽象的一种策略，通过包含所有潜在错误，确保不遗漏任何错误，即使这可能导致一些误报。"),l("li",null,"过近似可以在实际分析中保证正确性，但不能保证完全性，因为它可能会报告一些不存在的错误。")])],-1),l("hr",null,null,-1),l("h2",{id:"个人感悟",tabindex:"-1"},[n("个人感悟 "),l("a",{class:"header-anchor",href:"#个人感悟","aria-label":'Permalink to "个人感悟"'},"​")],-1),l("p",null,"本文概述了静态代码分析的一些原理，主要就是依赖于抽象过程、过近似分析。",-1)])),"main-header":a(()=>[i(t.$slots,"main-header")]),"main-header-after":a(()=>[i(t.$slots,"main-header-after")]),"main-nav":a(()=>[i(t.$slots,"main-nav")]),"main-content":a(()=>[i(t.$slots,"main-content")]),"main-content-after":a(()=>[i(t.$slots,"main-content-after")]),"main-nav-before":a(()=>[i(t.$slots,"main-nav-before")]),"main-nav-after":a(()=>[i(t.$slots,"main-nav-after")]),comment:a(()=>[i(t.$slots,"comment")]),footer:a(()=>[i(t.$slots,"footer")]),aside:a(()=>[i(t.$slots,"aside")]),"aside-custom":a(()=>[i(t.$slots,"aside-custom")]),default:a(()=>[i(t.$slots,"default")]),_:3},8,["frontmatter"])}}};export{F as default};

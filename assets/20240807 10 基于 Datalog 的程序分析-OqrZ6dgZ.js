import{_ as E}from"./ValaxyMain.vue_vue_type_style_index_0_lang-Bn109ln0.js";import{c as u,w as s,f as d,a as g,p as r,o as m,g as i,h as l,r as a}from"./app-DvGICojQ.js";import"./YunFooter.vue_vue_type_style_index_0_lang-6I6EwKPx.js";import"./YunCard.vue_vue_type_script_setup_true_lang-G2SLBOpE.js";import"./index-C5okkQwF.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang-B-GmT0Fn.js";import"./post-JeTKiWMk.js";const y="/assets/data-eg-B1Hxe9-8.png",c="/assets/rule-eg-CT6h06Cu.png",F="/assets/datalog-process-BP6DZFrv.png",C="/assets/logical-or-WiC4uty3.png",x="/assets/datalog-engine-BIajh5Eo.png",B="/assets/intra-pta-edb-u8QrLe4O.png",w="/assets/intra-pta-idb-CiC2kbkM.png",L={__name:"20240807 10 基于 Datalog 的程序分析",setup(b,{expose:o}){const n=JSON.parse('{"title":"10 基于 Datalog 的程序分析","description":"","frontmatter":{"title":"10 基于 Datalog 的程序分析","date":"2024-08-07T00:00:00.000Z","tags":["静态代码分析"],"categories":["静态代码分析"]},"headers":[{"level":2,"title":"10.1 命令式与申述式","slug":"_10-1-命令式与申述式","link":"#_10-1-命令式与申述式","children":[{"level":3,"title":"10.1.1 怎样实现程序分析","slug":"_10-1-1-怎样实现程序分析","link":"#_10-1-1-怎样实现程序分析","children":[]}]},{"level":2,"title":"10.2 Datalog 语言初步","slug":"_10-2-datalog-语言初步","link":"#_10-2-datalog-语言初步","children":[{"level":3,"title":"10.2.1 介绍","slug":"_10-2-1-介绍","link":"#_10-2-1-介绍","children":[]},{"level":3,"title":"10.2.2 原子","slug":"_10-2-2-原子","link":"#_10-2-2-原子","children":[]},{"level":3,"title":"10.2.3 规则","slug":"_10-2-3-规则","link":"#_10-2-3-规则","children":[]},{"level":3,"title":"10.2.4 EDB 和 IDB 谓词","slug":"_10-2-4-edb-和-idb-谓词","link":"#_10-2-4-edb-和-idb-谓词","children":[]},{"level":3,"title":"10.2.5 析取和否定","slug":"_10-2-5-析取和否定","link":"#_10-2-5-析取和否定","children":[]},{"level":3,"title":"10.2.6 递归","slug":"_10-2-6-递归","link":"#_10-2-6-递归","children":[]},{"level":3,"title":"10.2.7 规则安全","slug":"_10-2-7-规则安全","link":"#_10-2-7-规则安全","children":[]},{"level":3,"title":"10.2.8 Datalog 程序的执行","slug":"_10-2-8-datalog-程序的执行","link":"#_10-2-8-datalog-程序的执行","children":[]}]},{"level":2,"title":"10.3 使用 Datalog 进行指针分析","slug":"_10-3-使用-datalog-进行指针分析","link":"#_10-3-使用-datalog-进行指针分析","children":[{"level":3,"title":"10.3.1 分析思路","slug":"_10-3-1-分析思路","link":"#_10-3-1-分析思路","children":[]},{"level":3,"title":"10.3.2 指针分析的 Datalog 建模","slug":"_10-3-2-指针分析的-datalog-建模","link":"#_10-3-2-指针分析的-datalog-建模","children":[]},{"level":3,"title":"10.3.3 指针分析的 Datalog 规则","slug":"_10-3-3-指针分析的-datalog-规则","link":"#_10-3-3-指针分析的-datalog-规则","children":[]},{"level":3,"title":"10.3.4 处理方法调用","slug":"_10-3-4-处理方法调用","link":"#_10-3-4-处理方法调用","children":[]},{"level":3,"title":"10.3.5 全程序指针分析的Datalog实现","slug":"_10-3-5-全程序指针分析的datalog实现","link":"#_10-3-5-全程序指针分析的datalog实现","children":[]}]},{"level":2,"title":"10.4 使用Datalog进行污点分析","slug":"_10-4-使用datalog进行污点分析","link":"#_10-4-使用datalog进行污点分析","children":[{"level":3,"title":"10.4.1 污点分析的Datalog建模","slug":"_10-4-1-污点分析的datalog建模","link":"#_10-4-1-污点分析的datalog建模","children":[]},{"level":3,"title":"10.4.2 污点分析的Datalog实现","slug":"_10-4-2-污点分析的datalog实现","link":"#_10-4-2-污点分析的datalog实现","children":[]}]},{"level":2,"title":"10.5 基于Datalog的程序分析的优缺点","slug":"_10-5-基于datalog的程序分析的优缺点","link":"#_10-5-基于datalog的程序分析的优缺点","children":[]},{"level":2,"title":"10.6 自检问题","slug":"_10-6-自检问题","link":"#_10-6-自检问题","children":[]}],"relativePath":"pages/posts/静态代码分析/20240807 10 基于 Datalog 的程序分析/20240807 10 基于 Datalog 的程序分析.md","path":"/home/runner/work/LiuZhuJunYa.github.io/LiuZhuJunYa.github.io/pages/posts/静态代码分析/20240807 10 基于 Datalog 的程序分析/20240807 10 基于 Datalog 的程序分析.md","lastUpdated":1731428437000}'),e=g(),h=n.frontmatter||{};return e.meta.frontmatter=Object.assign(e.meta.frontmatter||{},n.frontmatter||{}),r("pageData",n),r("valaxy:frontmatter",h),globalThis.$frontmatter=h,o({frontmatter:{title:"10 基于 Datalog 的程序分析",date:"2024-08-07T00:00:00.000Z",tags:["静态代码分析"],categories:["静态代码分析"]}}),(t,k)=>{const p=E;return m(),u(p,{frontmatter:d(h)},{"main-content-md":s(()=>k[0]||(k[0]=[i("p",null,[l("原文链接："),i("a",{href:"https://static-analysis.cuijiacai.com/10-datalog/",target:"_blank",rel:"noreferrer"},"https://static-analysis.cuijiacai.com/10-datalog/")],-1),i("h1",{id:"_10-基于-datalog-的程序分析",tabindex:"-1"},[l("10 基于 Datalog 的程序分析 "),i("a",{class:"header-anchor",href:"#_10-基于-datalog-的程序分析","aria-label":'Permalink to "10 基于 Datalog 的程序分析"'},"​")],-1),i("h2",{id:"_10-1-命令式与申述式",tabindex:"-1"},[l("10.1 命令式与申述式 "),i("a",{class:"header-anchor",href:"#_10-1-命令式与申述式","aria-label":'Permalink to "10.1 命令式与申述式"'},"​")],-1),i("div",{class:"definition"},[i("p",{class:"title"},"定义10.1"),i("p",null,[l("称描述怎么做的编程语言是 "),i("strong",null,"命令式（Imperative）"),l(" 的，其内容是一个目标的 "),i("strong",null,"实现（Implementation）"),l(" ；描述做什么的语言是 "),i("strong",null,"申述式（Declarative）"),l(" 的，其内容是一个目标的 "),i("strong",null,"规约（Specification）"),l(" 。")])],-1),i("p",null,"比如说，如果我要从一群人的集合，要选出其中的成年人，命令式的程序写法应该是：",-1),i("div",{class:"language-java vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Set"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Person"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," selectAdults"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Set"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Person"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," people) {")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    Set<"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Person"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> result "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," HashSet<>();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    for"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (Person person "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," people)")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (person."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getAge"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 18"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            result."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"add"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(person);")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    return"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," result;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"collapse"})],-1),i("p",null,"而申述式的程序写法则是：",-1),i("div",{class:"language-sql vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"sql"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"SELECT"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," *"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," FROM"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," People "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"WHERE"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Age "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 18"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")])])]),i("button",{class:"collapse"})],-1),i("h3",{id:"_10-1-1-怎样实现程序分析",tabindex:"-1"},[l("10.1.1 怎样实现程序分析 "),i("a",{class:"header-anchor",href:"#_10-1-1-怎样实现程序分析","aria-label":'Permalink to "10.1.1 怎样实现程序分析"'},"​")],-1),i("p",null,"我们之前的所有的实现静态分析的方式都是命令式的，通过一个具体的图算法来实现。以指针分析为例，我们花了很大的篇幅来讲解算法的步骤。不过在讲解具体的算法之前，我们其实已经有了一个定义良好的规约，就是我们下面的这些规则（以上下文不敏感为例）。",-1),i("table",null,[i("thead",null,[i("tr",null,[i("th",{style:{"text-align":"center"}},"类型"),i("th",{style:{"text-align":"center"}},"语句"),i("th",{style:{"text-align":"center"}},"规则")])]),i("tbody",null,[i("tr",null,[i("td",{style:{"text-align":"center"}},"创建"),i("td",{style:{"text-align":"center"}},[i("code",null,"i: x = new T()")]),i("td",{style:{"text-align":"center"}},[i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("mover",{accent:"true"},[i("mrow",null,[i("msub",null,[i("mi",null,"o"),i("mi",null,"i")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("mi",null,"x"),i("mo",{stretchy:"false"},")")]),i("mo",{stretchy:"true"},"‾")])]),i("annotation",{encoding:"application/x-tex"},"\\overline{o_i \\in pt(x)}")])])])])]),i("tr",null,[i("td",{style:{"text-align":"center"}},"赋值"),i("td",{style:{"text-align":"center"}},[i("code",null,"x = y")]),i("td",{style:{"text-align":"center"}},[i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("msub",null,[i("mi",null,"o"),i("mi",null,"i")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("mi",null,"y"),i("mo",{stretchy:"false"},")")]),i("annotation",{encoding:"application/x-tex"},"o_i\\in pt(y)")])])]),i("br"),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("mover",{accent:"true"},[i("mrow",null,[i("msub",null,[i("mi",null,"o"),i("mi",null,"i")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("mi",null,"x"),i("mo",{stretchy:"false"},")")]),i("mo",{stretchy:"true"},"‾")])]),i("annotation",{encoding:"application/x-tex"},"\\overline{o_i \\in pt(x)}")])])])])]),i("tr",null,[i("td",{style:{"text-align":"center"}},"存储"),i("td",{style:{"text-align":"center"}},[i("code",null,"x.f = y")]),i("td",{style:{"text-align":"center"}},[i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("munder",{accentunder:"true"},[i("mrow",null,[i("msub",null,[i("mi",null,"o"),i("mi",null,"i")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("mi",null,"x"),i("mo",{stretchy:"false"},")"),i("mo",{separator:"true"},","),i("msub",null,[i("mi",null,"o"),i("mi",null,"j")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("mi",null,"y"),i("mo",{stretchy:"false"},")")]),i("mo",{stretchy:"true"},"‾")])]),i("annotation",{encoding:"application/x-tex"},"\\underline{o_i \\in pt(x), o_j\\in pt(y)}")])])]),i("br"),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("msub",null,[i("mi",null,"o"),i("mi",null,"j")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("msub",null,[i("mi",null,"o"),i("mi",null,"i")]),i("mi",{mathvariant:"normal"},"."),i("mi",null,"f"),i("mo",{stretchy:"false"},")")]),i("annotation",{encoding:"application/x-tex"},"o_j \\in pt(o_i.f)")])])])])]),i("tr",null,[i("td",{style:{"text-align":"center"}},"载入"),i("td",{style:{"text-align":"center"}},[i("code",null,"y = x.f")]),i("td",{style:{"text-align":"center"}},[i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("munder",{accentunder:"true"},[i("mrow",null,[i("msub",null,[i("mi",null,"o"),i("mi",null,"i")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("mi",null,"x"),i("mo",{stretchy:"false"},")"),i("mo",{separator:"true"},","),i("msub",null,[i("mi",null,"o"),i("mi",null,"j")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("msub",null,[i("mi",null,"o"),i("mi",null,"i")]),i("mi",{mathvariant:"normal"},"."),i("mi",null,"f"),i("mo",{stretchy:"false"},")")]),i("mo",{stretchy:"true"},"‾")])]),i("annotation",{encoding:"application/x-tex"},"\\underline{o_i\\in pt(x), o_j\\in pt(o_i.f)}")])])]),i("br"),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("msub",null,[i("mi",null,"o"),i("mi",null,"j")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("mi",null,"y"),i("mo",{stretchy:"false"},")")]),i("annotation",{encoding:"application/x-tex"},"o_j\\in pt(y)")])])])])]),i("tr",null,[i("td",{style:{"text-align":"center"}},"调用"),i("td",{style:{"text-align":"center"}},[i("code",null,"l: r = x.k(a1, ..., an)")]),i("td",{style:{"text-align":"center"}},[i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("msub",null,[i("mi",null,"o"),i("mi",null,"i")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("mi",null,"x"),i("mo",{stretchy:"false"},")"),i("mo",{separator:"true"},","),i("mi",null,"m"),i("mo",null,"="),i("mi",null,"D"),i("mi",null,"i"),i("mi",null,"s"),i("mi",null,"p"),i("mi",null,"a"),i("mi",null,"t"),i("mi",null,"c"),i("mi",null,"h"),i("mo",{stretchy:"false"},"("),i("msub",null,[i("mi",null,"o"),i("mi",null,"i")]),i("mo",{separator:"true"},","),i("mi",null,"k"),i("mo",{stretchy:"false"},")")]),i("annotation",{encoding:"application/x-tex"},"o_i\\in pt(x), m=Dispatch(o_i, k)")])])]),i("br"),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("msub",null,[i("mi",null,"o"),i("mi",null,"u")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("msub",null,[i("mi",null,"a"),i("mi",null,"j")]),i("mo",{stretchy:"false"},")"),i("mo",{separator:"true"},","),i("mn",null,"1"),i("mo",null,"≤"),i("mi",null,"j"),i("mo",null,"≤"),i("mi",null,"n")]),i("annotation",{encoding:"application/x-tex"},"o_u\\in pt(a_j), 1\\le j\\le n")])])]),i("br"),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("msub",null,[i("mi",null,"o"),i("mi",null,"v")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("msub",null,[i("mi",null,"m"),i("mrow",null,[i("mi",null,"r"),i("mi",null,"e"),i("mi",null,"t")])]),i("mo",{stretchy:"false"},")")]),i("annotation",{encoding:"application/x-tex"},"o_v\\in pt(m_{ret})")])])]),i("br"),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("mover",{accent:"true"},[i("mrow",null,[i("msub",null,[i("mi",null,"o"),i("mi",null,"i")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("msub",null,[i("mi",null,"m"),i("mrow",null,[i("mi",null,"t"),i("mi",null,"h"),i("mi",null,"i"),i("mi",null,"s")])]),i("mo",{stretchy:"false"},")")]),i("mo",{stretchy:"true"},"‾")])]),i("annotation",{encoding:"application/x-tex"},"\\overline{o_i\\in pt(m_{this})}")])])]),i("br"),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("msub",null,[i("mi",null,"o"),i("mi",null,"u")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("msub",null,[i("mi",null,"m"),i("msub",null,[i("mi",null,"p"),i("mi",null,"j")])]),i("mo",{stretchy:"false"},")"),i("mo",{separator:"true"},","),i("mn",null,"1"),i("mo",null,"≤"),i("mi",null,"j"),i("mo",null,"≤"),i("mi",null,"n")]),i("annotation",{encoding:"application/x-tex"},"o_u\\in pt(m_{p_j}), 1\\le j\\le n")])])]),i("br"),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("msub",null,[i("mi",null,"o"),i("mi",null,"v")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("mi",null,"r"),i("mo",{stretchy:"false"},")")]),i("annotation",{encoding:"application/x-tex"},"o_v\\in pt(r)")])])])])])])],-1),i("p",null,"基于上述的规则，我们设计了算法7.2，但其实算法7.2在具体实现的时候还有许多细节上需要考虑的地方：",-1),i("ul",null,[i("li",null,[i("p",null,[l("如何实现 "),i("code",null,"Worklist"),l(" ?")]),i("ul",null,[i("li",null,[i("p",null,[l("使用 "),i("code",null,"ArrayList"),l(" 还是 "),i("code",null,"LinkedList"),l(" ？（算法7.2第 1 行）")])]),i("li",null,[i("p",null,[i("code",null,"Worklist"),l(" 中的哪一项应当被先处理？（算法7.2第 10 行）")])])])]),i("li",null,[i("p",null,[l("如何实现指向集 "),i("code",null,"pt"),l(" ？")]),i("ul",null,[i("li",null,[i("code",null,"HashSet"),l(" 或者 "),i("code",null,"BitVector"),l(" ?（算法7.2第 32 行）")])])]),i("li",null,[i("p",null,"怎样联系 PFG 结点和指针？（算法7.2第 13 行）")]),i("li",null,[i("p",null,"如何将变量和相关语句联系起来？（算法7.2第 15、18 行）")]),i("li",null,[i("p",null,"…")])],-1),i("p",null,"我们还有很多很多的实现细节要考虑，这是很让人头疼的，这是在进行指针分析时使用命令式编程的困境。",-1),i("p",null,"当然，我们并不能贬低命令式编程，因为使用申述式编程的便捷性是由其他人承受了其背后的苦楚而换来的，追根究底还得是命令式编程，毕竟机器就是机器。",-1),i("p",null,"接下来，我们会介绍一种申述式的编程语言Datalog，能够极大地简化指针分析的实现，我们只需要描述规约即可，代码简介且可读性强。",-1),i("p",null,"最终的代码如下：",-1),i("div",{class:"language-prolog vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"prolog"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"VarPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"x"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"o"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") <-")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    Reachable"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"m"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    New"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"x"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"o"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"m"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},".")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"VarPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"x"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"o"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") <-")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    Assign"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"x"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"y"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    VarPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"y"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"o"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},".")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"FieldPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"oi"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"f"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"oj"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") <-")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    Store"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"x"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"f"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"y"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    VarPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"x"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"oi"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    VarPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"y"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"oj"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},".")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"VarPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"y"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"oj"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") <-")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    Load"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"y"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"x"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"f"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    VarPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"x"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"oi"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    FieldPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"oi"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"f"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"oj"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},".")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"VarPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"o"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"Reachable"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"m"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"CallGraph"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"l"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"m"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") <-")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    VCall"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"l"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"x"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"k"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    VarPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"x"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"o"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    Dispatch"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"o"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"k"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"m"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    ThisVar"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"m"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},".")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"VarPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"pi"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"o"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") <-")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    CallGraph"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"l"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"m"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    Argument"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"l"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"i"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"ai"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    Parameter"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"m"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"i"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"pi"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    VarPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"ai"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"o"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},".")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"VarPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"r"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"o"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") <-")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    CallGraph"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"l"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"m"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    MethodReturn"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"m"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"ret"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    VarPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"ret"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"o"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    CallReturn"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"l"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"r"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},".")])])]),i("button",{class:"collapse"})],-1),i("p",null,"现在看不懂没关系，我们后面会讲解Datalog的语法语义。",-1),i("h2",{id:"_10-2-datalog-语言初步",tabindex:"-1"},[l("10.2 Datalog 语言初步 "),i("a",{class:"header-anchor",href:"#_10-2-datalog-语言初步","aria-label":'Permalink to "10.2 Datalog 语言初步"'},"​")],-1),i("h3",{id:"_10-2-1-介绍",tabindex:"-1"},[l("10.2.1 介绍 "),i("a",{class:"header-anchor",href:"#_10-2-1-介绍","aria-label":'Permalink to "10.2.1 介绍"'},"​")],-1),i("p",null,"Datalog是一个申述式的逻辑编程语言，是Prolog语言的一个子集，它在上世纪80年代中叶作为一种数据库语言而出现。现在，它已经有了很多的应用，比如说：",-1),i("ul",null,[i("li",null,[i("p",null,"程序分析（Program Analysis）")]),i("li",null,[i("p",null,"申述式网络编程（Declarative Networking）")]),i("li",null,[i("p",null,"大数据（Big Data）")]),i("li",null,[i("p",null,"云计算（Cloud Computing）")]),i("li",null,[i("p",null,"…")])],-1),i("p",null,"Datalog 的语法语义由两部分组成，数据（Data）和逻辑（Logic），这种语言没有副作用，没有控制流，没有函数，也不是图灵完备的语言。在 Datalog 中，用谓词表示数据，用规则表示逻辑。",-1),i("h3",{id:"_10-2-2-原子",tabindex:"-1"},[l("10.2.2 原子 "),i("a",{class:"header-anchor",href:"#_10-2-2-原子","aria-label":'Permalink to "10.2.2 原子"'},"​")],-1),i("div",{class:"definition"},[i("p",{class:"title"},"定义10.2"),i("p",null,[l("在 Datalog 语言中，称返回值为 "),i("code",null,"True"),l(" 或者 "),i("code",null,"False"),l(" 的 "),i("strong",null,"表达式（Expression）"),l(" 为 "),i("strong",null,"原子（Atom）"),l(" 。")])],-1),i("div",{class:"definition"},[i("p",{class:"title"},"定义10.3"),i("p",null,"在 Datalog 语言中，称形如"),i("p",null,[i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[i("semantics",null,[i("mrow",null,[i("mi",null,"P"),i("mo",{stretchy:"false"},"("),i("msub",null,[i("mi",null,"x"),i("mn",null,"1")]),i("mo",{separator:"true"},","),i("msub",null,[i("mi",null,"x"),i("mn",null,"2")]),i("mo",{separator:"true"},","),i("mi",{mathvariant:"normal"},"."),i("mi",{mathvariant:"normal"},"."),i("mi",{mathvariant:"normal"},"."),i("mo",{separator:"true"},","),i("msub",null,[i("mi",null,"x"),i("mi",null,"n")]),i("mo",{stretchy:"false"},")")]),i("annotation",{encoding:"application/x-tex"},"P(x_1, x_2, ..., x_n) ")])])])]),i("p",null,[l("的表达式为 "),i("strong",null,"关系型原子（Relational Atoms）"),l(" ，其中 "),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("mi",null,"P")]),i("annotation",{encoding:"application/x-tex"},"P")])])]),l(" 称为 "),i("strong",null,"谓词（Predicates）"),l(" 或 "),i("strong",null,"关系（Relation）"),l(" ， "),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("msub",null,[i("mi",null,"x"),i("mi",null,"i")]),i("mo",{stretchy:"false"},"("),i("mn",null,"1"),i("mo",null,"≤"),i("mi",null,"i"),i("mo",null,"≤"),i("mi",null,"n"),i("mo",{stretchy:"false"},")")]),i("annotation",{encoding:"application/x-tex"},"x_i(1 \\le i \\le n)")])])]),l(" 称为 "),i("strong",null,"实参（Arguments）"),l(" 或者 "),i("strong",null,"项（Terms）"),l(" 。")]),i("p",null,[l("记 "),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("msub",null,[i("mi",null,"x"),i("mn",null,"1")]),i("mo",null,"∈"),i("msub",null,[i("mi",null,"X"),i("mn",null,"1")]),i("mo",{separator:"true"},","),i("msub",null,[i("mi",null,"x"),i("mn",null,"2")]),i("mo",null,"∈"),i("msub",null,[i("mi",null,"X"),i("mn",null,"2")]),i("mo",{separator:"true"},","),i("mi",{mathvariant:"normal"},"."),i("mi",{mathvariant:"normal"},"."),i("mi",{mathvariant:"normal"},"."),i("mo",{separator:"true"},","),i("msub",null,[i("mi",null,"x"),i("mi",null,"n")]),i("mo",null,"∈"),i("msub",null,[i("mi",null,"X"),i("mi",null,"n")])]),i("annotation",{encoding:"application/x-tex"},"x_1 \\in X_1, x_2\\in X_2, ..., x_n\\in X_n")])])]),l(" ，则有")]),i("p",null,[i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[i("semantics",null,[i("mrow",null,[i("mi",null,"P"),i("mo",null,"⊆"),i("msub",null,[i("mi",null,"X"),i("mn",null,"1")]),i("mo",null,"×"),i("msub",null,[i("mi",null,"X"),i("mn",null,"2")]),i("mo",null,"×"),i("mi",{mathvariant:"normal"},"."),i("mi",{mathvariant:"normal"},"."),i("mi",{mathvariant:"normal"},"."),i("mo",null,"×"),i("msub",null,[i("mi",null,"X"),i("mi",null,"n")])]),i("annotation",{encoding:"application/x-tex"},"P \\subseteq X_1\\times X_2\\times ...\\times X_n ")])])])]),i("p",null,"且定义"),i("p",null,[i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[i("semantics",null,[i("mrow",null,[i("mi",null,"P"),i("mo",{stretchy:"false"},"("),i("msub",null,[i("mi",null,"x"),i("mn",null,"1")]),i("mo",{separator:"true"},","),i("msub",null,[i("mi",null,"x"),i("mn",null,"2")]),i("mo",{separator:"true"},","),i("mi",{mathvariant:"normal"},"."),i("mi",{mathvariant:"normal"},"."),i("mi",{mathvariant:"normal"},"."),i("mo",{separator:"true"},","),i("msub",null,[i("mi",null,"x"),i("mi",null,"n")]),i("mo",{stretchy:"false"},")"),i("mo",null,"="),i("mi",null,"T"),i("mi",null,"r"),i("mi",null,"u"),i("mi",null,"e"),i("mo",null,"⇔"),i("mo",{stretchy:"false"},"("),i("msub",null,[i("mi",null,"x"),i("mn",null,"1")]),i("mo",{separator:"true"},","),i("msub",null,[i("mi",null,"x"),i("mn",null,"2")]),i("mo",{separator:"true"},","),i("mi",{mathvariant:"normal"},"."),i("mi",{mathvariant:"normal"},"."),i("mi",{mathvariant:"normal"},"."),i("mo",{separator:"true"},","),i("msub",null,[i("mi",null,"x"),i("mi",null,"m")]),i("mo",{stretchy:"false"},")"),i("mo",null,"∈"),i("mi",null,"P")]),i("annotation",{encoding:"application/x-tex"},"P(x_1, x_2, ..., x_n) = True \\Leftrightarrow (x_1, x_2, ..., x_m) \\in P ")])])])]),i("p",null,[l("此时，称为 "),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("mo",{stretchy:"false"},"("),i("msub",null,[i("mi",null,"x"),i("mn",null,"1")]),i("mo",{separator:"true"},","),i("msub",null,[i("mi",null,"x"),i("mn",null,"2")]),i("mo",{separator:"true"},","),i("mi",{mathvariant:"normal"},"."),i("mi",{mathvariant:"normal"},"."),i("mi",{mathvariant:"normal"},"."),i("mo",{separator:"true"},","),i("msub",null,[i("mi",null,"x"),i("mi",null,"n")]),i("mo",{stretchy:"false"},")")]),i("annotation",{encoding:"application/x-tex"},"(x_1, x_2, ..., x_n)")])])]),l(" 为 "),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("mi",null,"P")]),i("annotation",{encoding:"application/x-tex"},"P")])])]),l(" 中的一个 "),i("strong",null,"事实（Fact）"),l(" 。")])],-1),i("p",null,"从上面的定义中我们会发现，其实一个谓词就是一张表格，是每一列集合的笛卡尔积的子集。比如说：",-1),i("p",{style:{"text-align":"center"}},[i("img",{src:y,alt:"data-eg",style:{zoom:"25%"}})],-1),i("p",null,[i("code",null,"Age"),l(" 是一个谓词，表示了一些人的年龄，对于 "),i("code",null,"Age"),l(" 来说：")],-1),i("ul",null,[i("li",null,[i("p",null,[i("code",null,'("Xiaoming", 18)'),l(" 表示小明 18 岁，是一个事实，所以 "),i("code",null,'Age("Xiaoming", 18)'),l(" 返回值为真；")])]),i("li",null,[i("p",null,[i("code",null,'("Abao", 23)'),l(" 表示阿宝 23 岁，这不是一个事实，所以 "),i("code",null,'Age("Alan", 23)'),l(" 返回值为假。")])])],-1),i("div",{class:"definition"},[i("p",{class:"title"},"定义10.4"),i("p",null,[l("在Datalog语言中，称可判定真假的代数表达式为 "),i("strong",null,"代数型原子（Arithmetic Atoms）"),l(" 。")])],-1),i("p",null,[l("比如说 "),i("code",null,"age >= 18"),l(" 就是一个代数型原子。")],-1),i("h3",{id:"_10-2-3-规则",tabindex:"-1"},[l("10.2.3 规则 "),i("a",{class:"header-anchor",href:"#_10-2-3-规则","aria-label":'Permalink to "10.2.3 规则"'},"​")],-1),i("div",{class:"definition"},[i("p",{class:"title"},"定义10.5"),i("p",null,"在Datalog语言中，称形如"),i("p",null,[i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[i("semantics",null,[i("mrow",null,[i("mi",null,"H"),i("mo",null,"←"),i("msub",null,[i("mi",null,"B"),i("mn",null,"1")]),i("mo",{separator:"true"},","),i("msub",null,[i("mi",null,"B"),i("mn",null,"2")]),i("mo",{separator:"true"},","),i("mi",{mathvariant:"normal"},"."),i("mi",{mathvariant:"normal"},"."),i("mi",{mathvariant:"normal"},"."),i("mo",{separator:"true"},","),i("msub",null,[i("mi",null,"B"),i("mi",null,"n")]),i("mi",{mathvariant:"normal"},".")]),i("annotation",{encoding:"application/x-tex"},"H \\leftarrow B_1, B_2, ..., B_n. ")])])])]),i("p",null,[l("的语句为"),i("strong",null,"规则（Rules）"),l("，其中：")]),i("ul",null,[i("li",null,[i("p",null,[i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("mi",null,"H")]),i("annotation",{encoding:"application/x-tex"},"H")])])]),l(" 称为"),i("strong",null,"头部（Header）"),l("，是规则的"),i("strong",null,"结果（Consequent）"),l("，其形式上是一个原子。")])]),i("li",null,[i("p",null,[i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("msub",null,[i("mi",null,"B"),i("mn",null,"1")]),i("mo",{separator:"true"},","),i("msub",null,[i("mi",null,"B"),i("mn",null,"2")]),i("mo",{separator:"true"},","),i("mi",{mathvariant:"normal"},"."),i("mi",{mathvariant:"normal"},"."),i("mi",{mathvariant:"normal"},"."),i("mo",{separator:"true"},","),i("msub",null,[i("mi",null,"B"),i("mi",null,"n")])]),i("annotation",{encoding:"application/x-tex"},"B_1, B_2, ..., B_n")])])]),l(" 称为"),i("strong",null,"主体（Body）"),l("，是规则的"),i("strong",null,"前提（Antecedent）"),l("，其中的 "),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("msub",null,[i("mi",null,"B"),i("mi",null,"i")])]),i("annotation",{encoding:"application/x-tex"},"B_i")])])]),l(" 是一个原子或者原子的否定（见10.2.5），称为"),i("strong",null,"子目标（Subgoal）"),l("。")])])]),i("p",null,"规则的含义是如果主体为真，则头部为真。"),i("p",null,[l("这里 "),i("code",null,","),l(" 表示合取关系，即逻辑与，也就是说主体 "),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("msub",null,[i("mi",null,"B"),i("mn",null,"1")]),i("mo",{separator:"true"},","),i("msub",null,[i("mi",null,"B"),i("mn",null,"2")]),i("mo",{separator:"true"},","),i("mi",{mathvariant:"normal"},"."),i("mi",{mathvariant:"normal"},"."),i("mi",{mathvariant:"normal"},"."),i("mo",{separator:"true"},","),i("msub",null,[i("mi",null,"B"),i("mi",null,"n")])]),i("annotation",{encoding:"application/x-tex"},"B_1, B_2, ..., B_n")])])]),l(" 为真当且仅当所有的子目标 "),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("msub",null,[i("mi",null,"B"),i("mi",null,"i")]),i("mo",{stretchy:"false"},"("),i("mn",null,"1"),i("mo",null,"≤"),i("mi",null,"i"),i("mo",null,"≤"),i("mi",null,"n"),i("mo",{stretchy:"false"},")")]),i("annotation",{encoding:"application/x-tex"},"B_i(1\\le i\\le n)")])])]),l(" 都为真。")])],-1),i("p",null,"基于上述的定义，我们可以通过如下的 Datalog 规则来推导成年人。",-1),i("div",{class:"language-prolog vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"prolog"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Adult"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"person"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") <-")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    Age"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"person"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"age"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    age"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," >= "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"18"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},".")])])]),i("button",{class:"collapse"})],-1),i("p",null,"那么 Datalog 的解释器会如何解释这个规则呢？",-1),i("p",null,"Datalog 会考虑子目标中变量的所有可能的组合，如果存在某个组合使得所有的子目标都为真，那么带有相应变量的头部原子也为真。头部谓词会包含所有为真的原子的项，作为该谓词的事实存下来。",-1),i("p",null,"比如说上面的那个例子，执行过程如下：",-1),i("p",{style:{"text-align":"center"}},[i("img",{src:c,alt:"rule-eg",style:{zoom:"40%"}})],-1),i("p",null,"到此我们发现，一个Datalog程序的基本运行逻辑是根据现有的一些事实加上一些规则来推导出新的一些事实。",-1),i("p",{style:{"text-align":"center"}},[i("img",{src:F,alt:"datalog-process",style:{zoom:"35%"}})],-1),i("p",null,"到现在为止，我们学习了原子表达式，学习了规则语句，也就是说我们学习了判断事实，也学习了推导事实，那么最初的原始的事实从何而来呢？",-1),i("h3",{id:"_10-2-4-edb-和-idb-谓词",tabindex:"-1"},[l("10.2.4 EDB 和 IDB 谓词 "),i("a",{class:"header-anchor",href:"#_10-2-4-edb-和-idb-谓词","aria-label":'Permalink to "10.2.4 EDB 和 IDB 谓词"'},"​")],-1),i("p",null,"通常， Datalog 中的谓词有两类： EDB 和 IDB 。",-1),i("div",{class:"definition"},[i("p",{class:"title"},"定义10.5"),i("p",null,[l("在 Datalog 语言中，称先验定义的谓词为 "),i("strong",null,"外延数据库（Extensional Database， EDB）"),l(" ，其中的关系是不可修改的，可视为输入关系。")])],-1),i("div",{class:"definition"},[i("p",{class:"title"},"定义10.6"),i("p",null,[l("在 Datalog 语言中，称由规则建立的谓词为 "),i("strong",null,"内涵数据库（Intensional Database， IDB）"),l(" ，其中的关系是由规则推导出来的，可视为输出关系。")])],-1),i("div",{class:"conclusion"},[i("p",{class:"title"},"结论10.1"),i("p",null,"在 Datalog 本身的规约中，对于规则语句，其头部只能是 IDB ，但主体部分的原子既可以是 EDB ，也可以是 IDB 。换句话说， Datalog 支持递归的规则（Recursive Rules）。")],-1),i("h3",{id:"_10-2-5-析取和否定",tabindex:"-1"},[l("10.2.5 析取和否定 "),i("a",{class:"header-anchor",href:"#_10-2-5-析取和否定","aria-label":'Permalink to "10.2.5 析取和否定"'},"​")],-1),i("p",null,[l("我们已经见到了用 "),i("code",null,","),l(" 表示合取关系用法，下面我们来看一下析取和否定。")],-1),i("p",{style:{"text-align":"center"}},[i("img",{src:C,alt:"logical-or",style:{zoom:"40%"}})],-1),i("p",null,"在Datalog中，有两种方式来表达析取逻辑：",-1),i("ol",null,[i("li",null,[i("p",null,"书写多个具有相同头部的规则，其含义是任意一个规则都能够生成那个头部原子谓词中的事实。"),i("div",{class:"language-prolog vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"prolog"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"SportFan"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"person"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") <- "),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"Hobby"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"person"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"jogging"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},".")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"SportFan"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"person"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") <- "),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"Hobby"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"person"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"swimming"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},".")])])]),i("button",{class:"collapse"})])]),i("li",null,[i("p",null,[l("使用逻辑或操作符 "),i("code",null,";"),l("。")]),i("div",{class:"language-prolog vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"prolog"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"SportsFan"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"person"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") <-")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    Hobby"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"person"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"jogging"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    Hobby"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"person"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"swimming"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},".")])])]),i("button",{class:"collapse"})])])],-1),i("p",null,[l("上述两种表达方式的效果是等价的。其中需要注意一下的是，当 "),i("code",null,";"),l(" 操作符和 "),i("code",null,","),l(" 操作符混合使用的时候， "),i("code",null,","),l(" 的优先级是要高于 "),i("code",null,";"),l(" 的，所以，如果要优先运算析取关系，需要使用括号，例如 "),i("code",null,"H <- A, (B; C)"),l(" 。")],-1),i("p",null,[l("在Datalog的规则中，一个子目标也可以是某个原子的否定，写作 "),i("code",null,"!B(...)"),l(" ，表示 "),i("code",null,"B(...)"),l(" 的相反意思，即 "),i("code",null,"!B(...)"),l(" 为真当且仅当 "),i("code",null,"B(...)"),l(" 为假。")],-1),i("p",null,"比如说，如果我要计算需要补考的学生，我们可以这样写：",-1),i("div",{class:"language-prolog vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"prolog"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"MakeupExamStd"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"student"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") <-")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    Student"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"student"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    !"),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"PassedStd"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"student"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},".")])])]),i("button",{class:"collapse"})],-1),i("p",null,[l("其中， "),i("code",null,"Student"),l(" 储存了所有的学生， "),i("code",null,"PassedStd"),l(" 储存了通过考试的学生。")],-1),i("h3",{id:"_10-2-6-递归",tabindex:"-1"},[l("10.2.6 递归 "),i("a",{class:"header-anchor",href:"#_10-2-6-递归","aria-label":'Permalink to "10.2.6 递归"'},"​")],-1),i("p",null,"其实在结论10.1中，我们已经提到了Datalog支持递归，也就是说Datalog允许一个IDB是直接或者间接从它本身推到出来的。",-1),i("p",null,"比如说，我们可以计算通过如下的递归的规则来计算一个图的可达性信息（即传递闭包）：",-1),i("div",{class:"language-prolog vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"prolog"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Reach"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"from"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"to"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") <-")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    Edge"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"from"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"to"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},".")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Reach"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"from"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"to"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") <-")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    Reach"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"from"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"node"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    Edge"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"node"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"to"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},".")])])]),i("button",{class:"collapse"})],-1),i("p",null,[l("其中， "),i("code",null,"Edge(a, b)"),l(" 表示图中存在从结点 "),i("code",null,"a"),l(" 到结点 "),i("code",null,"b"),l(" 的边， "),i("code",null,"Reach(a, b)"),l(" 表示 "),i("code",null,"b"),l(" 从 "),i("code",null,"a"),l(" 可达。")],-1),i("p",null,[l("如果没有递归的话， Datalog 就只能表达基础的关系型代数的请求，就像形如 "),i("code",null,"SELECT-FROM-WHERE"),l(" 这样的 SQL 语句一样。")],-1),i("p",null,"但是有了递归， Datalog 就强大了许多，并且能够表达出更复杂的程序分析，比如说指针分析了。",-1),i("h3",{id:"_10-2-7-规则安全",tabindex:"-1"},[l("10.2.7 规则安全 "),i("a",{class:"header-anchor",href:"#_10-2-7-规则安全","aria-label":'Permalink to "10.2.7 规则安全"'},"​")],-1),i("p",null,"我们下面看两个例子来体会一下什么是不安全的规则。",-1),i("div",{class:"language-prolog vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"prolog"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"A"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"x"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") <- "),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"B"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"y"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"), "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"x"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," > "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"y"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},".")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"A"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"x"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") <- "),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"B"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"y"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"), !"),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"C"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"x"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"y"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},".")])])]),i("button",{class:"collapse"})],-1),i("p",null,[l("对于上面的这两个例子，都有无穷多个 "),i("code",null,"x"),l(" 能够满足规则，这使得 "),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("mi",null,"A")]),i("annotation",{encoding:"application/x-tex"},"A")])])]),l(" 成为了一个无穷的关系，这样的规则是不安全的，会导致程序无法终止，因此 Datalog 会拒绝这样的规则，只有安全的规则才会被允许。")],-1),i("p",null,"那什么样的表达式会限制变量的范围呢？非否定的关系型原子。于是，我们可以得到如下的结论：",-1),i("div",{class:"conclusion"},[i("p",{class:"title"},"结论10.2"),i("p",null,"如果一个规则中的每个变量都在至少一个非否定的关系型原子中出现过，那么这个规则就是安全（Safe）的。")],-1),i("p",null,"再看一个例子：",-1),i("div",{class:"language-prolog vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"prolog"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"A"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"x"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") <- "),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"B"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"x"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"), !"),i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"A"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"x"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},".")])])]),i("button",{class:"collapse"})],-1),i("p",null,[l("假设 "),i("code",null,"B(1)"),l(" 是真的，如果 "),i("code",null,"A(1)"),l(" 是假的，那么 "),i("code",null,"A(1)"),l(" 就是真的；如果 "),i("code",null,"A(1)"),l(" 是真的，那么 "),i("code",null,"A(1)"),l(" 就是假的。诶， "),i("code",null,"A(1)"),l(" 情何以堪…")],-1),i("p",null,"这个规则本身是矛盾（Contradictory）的并且没有任何意义。于是，我们可以总结一个如下的结论：",-1),i("div",{class:"conclusion"},[i("p",{class:"title"},"结论10.3"),i("p",null,"在 Datalog 中，一个原子的递归和否定必须分开，否则这个规则可能会包含矛盾，且逻辑推理无法收敛。")],-1),i("h3",{id:"_10-2-8-datalog-程序的执行",tabindex:"-1"},[l("10.2.8 Datalog 程序的执行 "),i("a",{class:"header-anchor",href:"#_10-2-8-datalog-程序的执行","aria-label":'Permalink to "10.2.8 Datalog 程序的执行"'},"​")],-1),i("p",null,"Datalog 语言本身只是一个规约，就像 SQL 一样，不同的 Datalog 引擎会有特性上的区别，不过不会违背语言本身的规约。一些现代的 Datalog 引擎有：LogicBlox, Souffle, XSB, Datomic, Flora-2, …",-1),i("p",null,"Datalog 引擎会根据给定的规则和 EDB 推导事实，直到没有任何新的事实可以被推导出为止，程序终止。",-1),i("p",{style:{"text-align":"center"}},[i("img",{src:x,alt:"datalog-engine",style:{zoom:"30%"}})],-1),i("p",null,"Datalog 程序具有单调性，因为它只会推导新的事实，而无法删除已有的事实。",-1),i("div",{class:"theorem"},[i("p",{class:"title"},"定理10.1"),i("p",null,"Datalog 程序总能够终止。")],-1),i("blockquote",null,[i("p",null,"证明：首先， Datalog 程序具有单调性，其次规则安全保证了 IDB 的所有可能值是有限的，从而根据单调有界原则， Datalog 程序总能够终止。")],-1),i("h2",{id:"_10-3-使用-datalog-进行指针分析",tabindex:"-1"},[l("10.3 使用 Datalog 进行指针分析 "),i("a",{class:"header-anchor",href:"#_10-3-使用-datalog-进行指针分析","aria-label":'Permalink to "10.3 使用 Datalog 进行指针分析"'},"​")],-1),i("p",null,"我们之前讲解指针分析的时候说过指针分析的过程可以视为求解一个约束系统的过程（见定义7.4）。结合这一讲前面的内容我们可以很明显的感受到， Datalog 语言就是一个很好的求解约束系统的语言。",-1),i("h3",{id:"_10-3-1-分析思路",tabindex:"-1"},[l("10.3.1 分析思路 "),i("a",{class:"header-anchor",href:"#_10-3-1-分析思路","aria-label":'Permalink to "10.3.1 分析思路"'},"​")],-1),i("p",null,"用 Datalog 进行指针分析的话，",-1),i("ul",null,[i("li",null,[i("p",null,"EDB 其实就是我们能够从程序句法上直接提取的指针相关的信息，")]),i("li",null,[i("p",null,"IDB 就是我们需要的指针分析的结果。")]),i("li",null,[i("p",null,"而规则其实就可以直接用指针分析的规则，"),i("ul",null,[i("li",null,"只需要从数学推导式的形式转化成 Datalog 规则的形式即可，并且这种转化几乎是一一对应的，实现起来非常简单。")])])],-1),i("p",null,"我们下面会先聚焦于过程内的情况，最后再讨论调用语句，拓展到全程序的指针分析。",-1),i("h3",{id:"_10-3-2-指针分析的-datalog-建模",tabindex:"-1"},[l("10.3.2 指针分析的 Datalog 建模 "),i("a",{class:"header-anchor",href:"#_10-3-2-指针分析的-datalog-建模","aria-label":'Permalink to "10.3.2 指针分析的 Datalog 建模"'},"​")],-1),i("p",null,"首先，我们以EDB的形式将要分析的语句存下来。",-1),i("table",null,[i("thead",null,[i("tr",null,[i("th",{style:{"text-align":"center"}},"类型"),i("th",{style:{"text-align":"center"}},"语句"),i("th",{style:{"text-align":"center"}},"EDB")])]),i("tbody",null,[i("tr",null,[i("td",{style:{"text-align":"center"}},"创建"),i("td",{style:{"text-align":"center"}},[i("code",null,"i: x = new T()")]),i("td",{style:{"text-align":"center"}},[i("code",null,"New(x: V, o: O)")])]),i("tr",null,[i("td",{style:{"text-align":"center"}},"赋值"),i("td",{style:{"text-align":"center"}},[i("code",null,"x = y")]),i("td",{style:{"text-align":"center"}},[i("code",null,"Assign(x: V, y: V)")])]),i("tr",null,[i("td",{style:{"text-align":"center"}},"存储"),i("td",{style:{"text-align":"center"}},[i("code",null,"x.f = y")]),i("td",{style:{"text-align":"center"}},[i("code",null,"Store(x: V, f: F, y: V)")])]),i("tr",null,[i("td",{style:{"text-align":"center"}},"载入"),i("td",{style:{"text-align":"center"}},[i("code",null,"y = x.f")]),i("td",{style:{"text-align":"center"}},[i("code",null,"Load(y: V, x: V, f: F)")])])])],-1),i("p",null,[l("其中，和之前指针分析一样， "),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("mi",null,"V")]),i("annotation",{encoding:"application/x-tex"},"V")])])]),l(" 是变量集合， "),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("mi",null,"F")]),i("annotation",{encoding:"application/x-tex"},"F")])])]),l(" 是字段集合， "),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("mi",null,"O")]),i("annotation",{encoding:"application/x-tex"},"O")])])]),l(" 是对象集合。")],-1),i("p",null,[l("指针分析的结果 IDB 的形式为 "),i("code",null,"VarPointsTo(v: V, o: O)"),l(" 和 "),i("code",null,"FieldPointsTo(oi: O, f: F, oj: O)"),l(" 。")],-1),i("p",null,"比如说",-1),i("ul",null,[i("li",null,[i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("mi",null,"V"),i("mi",null,"a"),i("mi",null,"r"),i("mi",null,"P"),i("mi",null,"o"),i("mi",null,"i"),i("mi",null,"n"),i("mi",null,"t"),i("mi",null,"s"),i("mi",null,"T"),i("mi",null,"o"),i("mo",{stretchy:"false"},"("),i("mi",null,"x"),i("mo",{separator:"true"},","),i("msub",null,[i("mi",null,"o"),i("mi",null,"i")]),i("mo",{stretchy:"false"},")")]),i("annotation",{encoding:"application/x-tex"},"VarPointsTo(x, o_i)")])])]),l(" 表示 "),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("msub",null,[i("mi",null,"o"),i("mi",null,"i")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("mi",null,"x"),i("mo",{stretchy:"false"},")")]),i("annotation",{encoding:"application/x-tex"},"o_i \\in pt(x)")])])]),l(" ，")]),i("li",null,[i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("mi",null,"F"),i("mi",null,"i"),i("mi",null,"e"),i("mi",null,"l"),i("mi",null,"d"),i("mi",null,"s"),i("mi",null,"P"),i("mi",null,"o"),i("mi",null,"i"),i("mi",null,"n"),i("mi",null,"t"),i("mi",null,"s"),i("mi",null,"T"),i("mi",null,"o"),i("mo",{stretchy:"false"},"("),i("msub",null,[i("mi",null,"o"),i("mi",null,"i")]),i("mo",{separator:"true"},","),i("mi",null,"f"),i("mo",{separator:"true"},","),i("msub",null,[i("mi",null,"o"),i("mi",null,"j")]),i("mo",{stretchy:"false"},")")]),i("annotation",{encoding:"application/x-tex"},"FieldsPointsTo(o_i, f, o_j)")])])]),l(" 表示 "),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("msub",null,[i("mi",null,"o"),i("mi",null,"j")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("msub",null,[i("mi",null,"o"),i("mi",null,"i")]),i("mi",{mathvariant:"normal"},"."),i("mi",null,"f"),i("mo",{stretchy:"false"},")")]),i("annotation",{encoding:"application/x-tex"},"o_j \\in pt(o_i.f)")])])]),l(" 。")])],-1),i("p",null,"例如，对于下面这个程序来说，",-1),i("div",{class:"language-java vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"java"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"b "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," C"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"a "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," b;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"c "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," C"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"c.f "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," a;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"d "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," c;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"c.f "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," d;")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"e "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," d.f;")])])]),i("button",{class:"collapse"})],-1),i("p",null,"它的EDB为：",-1),i("p",{style:{"text-align":"center"}},[i("img",{src:B,alt:"intra-pta-edb",style:{zoom:"35%"}})],-1),i("h3",{id:"_10-3-3-指针分析的-datalog-规则",tabindex:"-1"},[l("10.3.3 指针分析的 Datalog 规则 "),i("a",{class:"header-anchor",href:"#_10-3-3-指针分析的-datalog-规则","aria-label":'Permalink to "10.3.3 指针分析的 Datalog 规则"'},"​")],-1),i("p",null,"根据我们已经熟悉的指针分析的规则以及对应的语句，不难得到对应的Datalog规则如下：",-1),i("table",null,[i("thead",null,[i("tr",null,[i("th",{style:{"text-align":"center"}},"类型"),i("th",{style:{"text-align":"center"}},"语句"),i("th",{style:{"text-align":"center"}},"规则"),i("th",{style:{"text-align":"center"}},"Datalog")])]),i("tbody",null,[i("tr",null,[i("td",{style:{"text-align":"center"}},"创建"),i("td",{style:{"text-align":"center"}},[i("code",null,"i: x = new T()")]),i("td",{style:{"text-align":"center"}},[i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("mover",{accent:"true"},[i("mrow",null,[i("msub",null,[i("mi",null,"o"),i("mi",null,"i")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("mi",null,"x"),i("mo",{stretchy:"false"},")")]),i("mo",{stretchy:"true"},"‾")])]),i("annotation",{encoding:"application/x-tex"},"\\overline{o_i \\in pt(x)}")])])])]),i("td",{style:{"text-align":"center"}},[i("code",null,"VarPointsTo(x, o) <-"),i("br"),i("br"),i("code",null,"New(x, o).")])]),i("tr",null,[i("td",{style:{"text-align":"center"}},"赋值"),i("td",{style:{"text-align":"center"}},[i("code",null,"x = y")]),i("td",{style:{"text-align":"center"}},[i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("msub",null,[i("mi",null,"o"),i("mi",null,"i")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("mi",null,"y"),i("mo",{stretchy:"false"},")")]),i("annotation",{encoding:"application/x-tex"},"o_i\\in pt(y)")])])]),i("br"),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("mover",{accent:"true"},[i("mrow",null,[i("msub",null,[i("mi",null,"o"),i("mi",null,"i")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("mi",null,"x"),i("mo",{stretchy:"false"},")")]),i("mo",{stretchy:"true"},"‾")])]),i("annotation",{encoding:"application/x-tex"},"\\overline{o_i \\in pt(x)}")])])])]),i("td",{style:{"text-align":"center"}},[i("code",null,"VarPointsTo(x, o) <-"),i("br"),i("br"),i("code",null,"Assign(x, y),"),i("br"),i("br"),i("code",null,"VarPointsTo(y, o).")])]),i("tr",null,[i("td",{style:{"text-align":"center"}},"存储"),i("td",{style:{"text-align":"center"}},[i("code",null,"x.f = y")]),i("td",{style:{"text-align":"center"}},[i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("msub",null,[i("mi",null,"o"),i("mi",null,"i")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("mi",null,"x"),i("mo",{stretchy:"false"},")")]),i("annotation",{encoding:"application/x-tex"},"o_i \\in pt(x)")])])]),i("br"),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("munder",{accentunder:"true"},[i("mrow",null,[i("msub",null,[i("mi",null,"o"),i("mi",null,"j")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("mi",null,"y"),i("mo",{stretchy:"false"},")")]),i("mo",{stretchy:"true"},"‾")])]),i("annotation",{encoding:"application/x-tex"},"\\underline{o_j\\in pt(y)}")])])]),i("br"),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("msub",null,[i("mi",null,"o"),i("mi",null,"j")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("msub",null,[i("mi",null,"o"),i("mi",null,"i")]),i("mi",{mathvariant:"normal"},"."),i("mi",null,"f"),i("mo",{stretchy:"false"},")")]),i("annotation",{encoding:"application/x-tex"},"o_j \\in pt(o_i.f)")])])])]),i("td",{style:{"text-align":"center"}},[i("code",null,"FieldPointsTo(oi, f, oj) <-"),i("br"),i("br"),i("code",null,"Store(x, f, y),"),i("br"),i("br"),i("code",null,"VarPointsTo(x, oi),"),i("br"),i("br"),i("code",null,"VarPointsTo(y, oj).")])]),i("tr",null,[i("td",{style:{"text-align":"center"}},"载入"),i("td",{style:{"text-align":"center"}},[i("code",null,"y = x.f")]),i("td",{style:{"text-align":"center"}},[i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("msub",null,[i("mi",null,"o"),i("mi",null,"i")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("mi",null,"x"),i("mo",{stretchy:"false"},")")]),i("annotation",{encoding:"application/x-tex"},"o_i\\in pt(x)")])])]),i("br"),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("munder",{accentunder:"true"},[i("mrow",null,[i("msub",null,[i("mi",null,"o"),i("mi",null,"j")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("msub",null,[i("mi",null,"o"),i("mi",null,"i")]),i("mi",{mathvariant:"normal"},"."),i("mi",null,"f"),i("mo",{stretchy:"false"},")")]),i("mo",{stretchy:"true"},"‾")])]),i("annotation",{encoding:"application/x-tex"},"\\underline{o_j\\in pt(o_i.f)}")])])]),i("br"),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("msub",null,[i("mi",null,"o"),i("mi",null,"j")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("mi",null,"y"),i("mo",{stretchy:"false"},")")]),i("annotation",{encoding:"application/x-tex"},"o_j\\in pt(y)")])])])]),i("td",{style:{"text-align":"center"}},[i("code",null,"VarPointsTo(y, oj) <-"),i("br"),i("br"),i("code",null,"Load(y, x, f),"),i("br"),i("br"),i("code",null,"VarPointsTo(x, oi),"),i("br"),i("br"),i("code",null,"FieldPointsTo(oi, f, oj).")])])])],-1),i("p",null,"有了EDB，也有了规则，根据之前讲的Datalog语言的语义，我们也不难得到上面那个例子的IDB如下：",-1),i("p",{style:{"text-align":"center"}},[i("img",{src:w,alt:"intra-pta-idb",style:{zoom:"35%"}})],-1),i("h3",{id:"_10-3-4-处理方法调用",tabindex:"-1"},[l("10.3.4 处理方法调用 "),i("a",{class:"header-anchor",href:"#_10-3-4-处理方法调用","aria-label":'Permalink to "10.3.4 处理方法调用"'},"​")],-1),i("table",null,[i("thead",null,[i("tr",null,[i("th",{style:{"text-align":"center"}},"类型"),i("th",{style:{"text-align":"center"}},"语句"),i("th",{style:{"text-align":"center"}},"规则")])]),i("tbody",null,[i("tr",null,[i("td",{style:{"text-align":"center"}},"调用"),i("td",{style:{"text-align":"center"}},[i("code",null,"l: r = x.k(a1, ..., an)")]),i("td",{style:{"text-align":"center"}},[i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("msub",null,[i("mi",null,"o"),i("mi",null,"i")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("mi",null,"x"),i("mo",{stretchy:"false"},")"),i("mo",{separator:"true"},","),i("mi",null,"m"),i("mo",null,"="),i("mi",null,"D"),i("mi",null,"i"),i("mi",null,"s"),i("mi",null,"p"),i("mi",null,"a"),i("mi",null,"t"),i("mi",null,"c"),i("mi",null,"h"),i("mo",{stretchy:"false"},"("),i("msub",null,[i("mi",null,"o"),i("mi",null,"i")]),i("mo",{separator:"true"},","),i("mi",null,"k"),i("mo",{stretchy:"false"},")")]),i("annotation",{encoding:"application/x-tex"},"o_i\\in pt(x), m=Dispatch(o_i, k)")])])]),i("br"),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("msub",null,[i("mi",null,"o"),i("mi",null,"u")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("msub",null,[i("mi",null,"a"),i("mi",null,"j")]),i("mo",{stretchy:"false"},")"),i("mo",{separator:"true"},","),i("mn",null,"1"),i("mo",null,"≤"),i("mi",null,"j"),i("mo",null,"≤"),i("mi",null,"n")]),i("annotation",{encoding:"application/x-tex"},"o_u\\in pt(a_j), 1\\le j\\le n")])])]),i("br"),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("msub",null,[i("mi",null,"o"),i("mi",null,"v")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("msub",null,[i("mi",null,"m"),i("mrow",null,[i("mi",null,"r"),i("mi",null,"e"),i("mi",null,"t")])]),i("mo",{stretchy:"false"},")")]),i("annotation",{encoding:"application/x-tex"},"o_v\\in pt(m_{ret})")])])]),i("br"),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("mover",{accent:"true"},[i("mrow",null,[i("msub",null,[i("mi",null,"o"),i("mi",null,"i")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("msub",null,[i("mi",null,"m"),i("mrow",null,[i("mi",null,"t"),i("mi",null,"h"),i("mi",null,"i"),i("mi",null,"s")])]),i("mo",{stretchy:"false"},")")]),i("mo",{stretchy:"true"},"‾")])]),i("annotation",{encoding:"application/x-tex"},"\\overline{o_i\\in pt(m_{this})}")])])]),i("br"),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("msub",null,[i("mi",null,"o"),i("mi",null,"u")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("msub",null,[i("mi",null,"m"),i("msub",null,[i("mi",null,"p"),i("mi",null,"j")])]),i("mo",{stretchy:"false"},")"),i("mo",{separator:"true"},","),i("mn",null,"1"),i("mo",null,"≤"),i("mi",null,"j"),i("mo",null,"≤"),i("mi",null,"n")]),i("annotation",{encoding:"application/x-tex"},"o_u\\in pt(m_{p_j}), 1\\le j\\le n")])])]),i("br"),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("msub",null,[i("mi",null,"o"),i("mi",null,"v")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("mi",null,"r"),i("mo",{stretchy:"false"},")")]),i("annotation",{encoding:"application/x-tex"},"o_v\\in pt(r)")])])])])])])],-1),i("p",null,"方法调用的规则比较复杂，我们可以分成3个部分，分别对应了上表中的3行：",-1),i("ol",null,[i("li",null,[i("p",null,[l("方法派发与 "),i("code",null,"this"),l(" 变量绑定：")]),i("ul",null,[i("li",null,[i("p",null,"EDB："),i("ul",null,[i("li",null,[i("p",null,[i("code",null,"VCALL(l: S, x: V, k: M)")])]),i("li",null,[i("p",null,[i("code",null,"Dispatch(o: O, k: M, m: M)")])]),i("li",null,[i("p",null,[i("code",null,"ThisVar(m: M, this: V)")])])])]),i("li",null,[i("p",null,"IDB："),i("ul",null,[i("li",null,[i("p",null,[i("code",null,"Reachable(m: M)")])]),i("li",null,[i("p",null,[i("code",null,"CallGraph(l: S, m: M)")])])])]),i("li",null,[i("p",null,"其中，S是语句集合，M是方法集合。Datalog规则为："),i("div",{class:"language-prolog vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"prolog"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"VarPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"o"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"Reachable"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"m"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"CallGraph"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"l"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"m"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") <-")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    VCall"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"l"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"x"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"k"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    VarPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"x"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"o"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    Dispatch"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"o"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"k"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"m"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    ThisVar"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"m"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},".")])])]),i("button",{class:"collapse"})])])])]),i("li",null,[i("p",null,"将形参绑定到实参："),i("ul",null,[i("li",null,[i("p",null,"EDB："),i("ul",null,[i("li",null,[i("p",null,[i("code",null,"Argument(l: S, i: N*, ai: V)")])]),i("li",null,[i("p",null,[i("code",null,"Parameter(m: M, i: N*, pi: V)")]),i("ul",null,[i("li",null,[l("其中， "),i("code",null,"N*"),l(" 是正整数集。")])])])])]),i("li",null,[i("p",null,"Datalog规则为："),i("div",{class:"language-prolog vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"prolog"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"VarPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"pi"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"o"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") <-")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    CallGraph"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"l"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"m"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    Argument"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"l"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"i"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"ai"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    Parameter"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"m"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"i"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"pi"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    VarPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"ai"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"o"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},".")])])]),i("button",{class:"collapse"})])])])]),i("li",null,[i("p",null,"将返回值传递给接收变量："),i("ul",null,[i("li",null,[i("p",null,"EDB："),i("ul",null,[i("li",null,[i("p",null,[i("code",null,"MathodReturn(m: M, ret: V)")])]),i("li",null,[i("p",null,[i("code",null,"CallReturn(l: S, r: V)")])])])]),i("li",null,[i("p",null,"Datalog规则为："),i("div",{class:"language-prolog vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"prolog"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"VarPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"r"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"o"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") <-")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    CallGraph"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"l"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"m"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    MathodReturm"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"m"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"ret"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    VarPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"ret"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"o"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    CallReturn"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"l"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"r"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},".")])])]),i("button",{class:"collapse"})])])])])],-1),i("h3",{id:"_10-3-5-全程序指针分析的datalog实现",tabindex:"-1"},[l("10.3.5 全程序指针分析的Datalog实现 "),i("a",{class:"header-anchor",href:"#_10-3-5-全程序指针分析的datalog实现","aria-label":'Permalink to "10.3.5 全程序指针分析的Datalog实现"'},"​")],-1),i("p",null,"综上，一个全程序的指针分析的Datalog实现为：",-1),i("div",{class:"language-prolog vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"prolog"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Reachable"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"m"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") <-")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    EntryMethod"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"m"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},".")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"VarPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"x"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"o"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") <-")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    Reachable"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"m"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    New"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"x"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"o"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"m"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},".")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"VarPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"x"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"o"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") <-")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    Assign"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"x"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"y"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    VarPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"y"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"o"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},".")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"FieldPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"oi"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"f"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"oj"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") <-")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    Store"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"x"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"f"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"y"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    VarPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"x"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"oi"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    VarPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"y"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"oj"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},".")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"VarPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"y"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"oj"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") <-")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    Load"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"y"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"x"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"f"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    VarPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"x"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"oi"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    FieldPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"oi"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"f"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"oj"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},".")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"VarPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"o"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"Reachable"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"m"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"CallGraph"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"l"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"m"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") <-")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    VCall"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"l"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"x"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"k"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    VarPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"x"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"o"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    Dispatch"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"o"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"k"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"m"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    ThisVar"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"m"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},".")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"VarPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"pi"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"o"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") <-")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    CallGraph"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"l"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"m"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    Argument"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"l"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"i"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"ai"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    Parameter"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"m"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"i"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"pi"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    VarPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"ai"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"o"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},".")]),l(`
`),i("span",{class:"line"}),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"VarPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"r"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"o"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") <-")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    CallGraph"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"l"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"m"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    MethodReturn"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"m"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"ret"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    VarPointsTo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"ret"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"o"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),")]),l(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    CallReturn"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"l"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"r"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},".")])])]),i("button",{class:"collapse"})],-1),i("blockquote",null,[i("p",null,"其中，我们添加了入口方法的相关逻辑。")],-1),i("h2",{id:"_10-4-使用datalog进行污点分析",tabindex:"-1"},[l("10.4 使用Datalog进行污点分析 "),i("a",{class:"header-anchor",href:"#_10-4-使用datalog进行污点分析","aria-label":'Permalink to "10.4 使用Datalog进行污点分析"'},"​")],-1),i("p",null,"上一讲我们的污点分析是建立在指针分析的基础上的，这一讲我们已经用Datalog实现了指针分析，基于这个实现，再添加一些规则，就可以很容易地实现污点分析了。",-1),i("h3",{id:"_10-4-1-污点分析的datalog建模",tabindex:"-1"},[l("10.4.1 污点分析的Datalog建模 "),i("a",{class:"header-anchor",href:"#_10-4-1-污点分析的datalog建模","aria-label":'Permalink to "10.4.1 污点分析的Datalog建模"'},"​")],-1),i("p",null,"基于指针分析，下面只描述指针分析以外的部分。",-1),i("ul",null,[i("li",null,[i("p",null,"EDB 谓词："),i("ul",null,[i("li",null,[i("p",null,[i("code",null,"Source(m: M)"),l(" 污点源方法；")])]),i("li",null,[i("p",null,[i("code",null,"Sink(m: M, i: N*)"),l(" 槽方法；")])]),i("li",null,[i("p",null,[i("code",null,"Taint(l: S, t: T)"),l(" 联系调用点和从调用点出来的污点数据。")])])])]),i("li",null,[i("p",null,"IDB 谓词"),i("ul",null,[i("li",null,[i("p",null,[i("code",null,"TaintFlow(sr: S, sn: S, i: N*)"),l(" 检测到的污点流。")]),i("ul",null,[i("li",null,[i("code",null,"TaintFlow(sr, sn, i)"),l(" 表示从 "),i("code",null,"sr"),l(" 流出的污点数据可能会流到槽调用 "),i("code",null,"sn"),l(" 的第 "),i("code",null,"i"),l(" 个参数中。")])])])])])],-1),i("h3",{id:"_10-4-2-污点分析的datalog实现",tabindex:"-1"},[l("10.4.2 污点分析的Datalog实现 "),i("a",{class:"header-anchor",href:"#_10-4-2-污点分析的datalog实现","aria-label":'Permalink to "10.4.2 污点分析的Datalog实现"'},"​")],-1),i("ul",null,[i("li",null,"处理源头（生成污点数据）")],-1),i("table",null,[i("thead",null,[i("tr",null,[i("th",{style:{"text-align":"center"}},"类型"),i("th",{style:{"text-align":"center"}},"语句"),i("th",{style:{"text-align":"center"}},"规则"),i("th",{style:{"text-align":"center"}},"Datalog")])]),i("tbody",null,[i("tr",null,[i("td",{style:{"text-align":"center"}},"调用"),i("td",{style:{"text-align":"center"}},[i("code",null,"l: r = x.k(a1, ..., an)")]),i("td",{style:{"text-align":"center"}},[i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("mi",null,"l"),i("mo",null,"→"),i("mi",null,"m"),i("mo",null,"∈"),i("mi",null,"C"),i("mi",null,"G")]),i("annotation",{encoding:"application/x-tex"},"l\\to m\\in CG")])])]),i("br"),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("munder",{accentunder:"true"},[i("mrow",null,[i("mi",null,"m"),i("mo",null,"∈"),i("mi",null,"S"),i("mi",null,"o"),i("mi",null,"u"),i("mi",null,"r"),i("mi",null,"c"),i("mi",null,"e"),i("mi",null,"s")]),i("mo",{stretchy:"true"},"‾")])]),i("annotation",{encoding:"application/x-tex"},"\\underline{m\\in Sources}")])])]),i("br"),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("msub",null,[i("mi",null,"t"),i("mi",null,"l")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("mi",null,"r"),i("mo",{stretchy:"false"},")")]),i("annotation",{encoding:"application/x-tex"},"t_l \\in pt(r)")])])])]),i("td",{style:{"text-align":"center"}},[i("code",null,"VarPointsTo(r, t) <-"),i("br"),i("br"),i("code",null,"CallGraph(l, m),"),i("br"),i("br"),i("code",null,"Source(m),"),i("br"),i("br"),i("code",null,"CallReturn(l, r),"),i("br"),i("br"),i("code",null,"Taint(l, t).")])])])],-1),i("ul",null,[i("li",null,"处理槽（生成污点流信息）")],-1),i("table",null,[i("thead",null,[i("tr",null,[i("th",{style:{"text-align":"center"}},"类型"),i("th",{style:{"text-align":"center"}},"语句"),i("th",{style:{"text-align":"center"}},"规则"),i("th",{style:{"text-align":"center"}},"Datalog")])]),i("tbody",null,[i("tr",null,[i("td",{style:{"text-align":"center"}},"调用"),i("td",{style:{"text-align":"center"}},[i("code",null,"l: r = x.k(a1, ..., an)")]),i("td",{style:{"text-align":"center"}},[i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("mi",null,"l"),i("mo",null,"→"),i("mi",null,"m"),i("mo",null,"∈"),i("mi",null,"C"),i("mi",null,"G")]),i("annotation",{encoding:"application/x-tex"},"l\\to m\\in CG")])])]),i("br"),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("mo",{stretchy:"false"},"("),i("mi",null,"m"),i("mo",{separator:"true"},","),i("mi",null,"i"),i("mo",{stretchy:"false"},")"),i("mo",null,"∈"),i("mi",null,"S"),i("mi",null,"i"),i("mi",null,"n"),i("mi",null,"k"),i("mi",null,"s")]),i("annotation",{encoding:"application/x-tex"},"(m, i) \\in Sinks")])])]),i("br"),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("msub",null,[i("mi",null,"t"),i("mi",null,"j")]),i("mo",null,"∈"),i("mi",null,"p"),i("mi",null,"t"),i("mo",{stretchy:"false"},"("),i("msub",null,[i("mi",null,"a"),i("mi",null,"i")]),i("mo",{stretchy:"false"},")")]),i("annotation",{encoding:"application/x-tex"},"t_j\\in pt(a_i)")])])]),i("br"),i("span",{class:"katex"},[i("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[i("semantics",null,[i("mrow",null,[i("mover",{accent:"true"},[i("mrow",null,[i("mo",{stretchy:"false"},"("),i("mi",null,"j"),i("mo",{separator:"true"},","),i("mi",null,"l"),i("mo",{separator:"true"},","),i("mi",null,"i"),i("mo",{stretchy:"false"},")"),i("mo",null,"∈"),i("mi",null,"T"),i("mi",null,"a"),i("mi",null,"i"),i("mi",null,"n"),i("mi",null,"t"),i("mi",null,"F"),i("mi",null,"l"),i("mi",null,"o"),i("mi",null,"w"),i("mi",null,"s")]),i("mo",{stretchy:"true"},"‾")])]),i("annotation",{encoding:"application/x-tex"},"\\overline{(j, l, i) \\in TaintFlows}")])])])]),i("td",{style:{"text-align":"center"}},[i("code",null,"TaintFlow(j, l, i) <-"),i("br"),i("br"),i("code",null,"CallGraph(l, m),"),i("br"),i("br"),i("code",null,"Sink(m, i),"),i("br"),i("br"),i("code",null,"Argument(l, i, ai),"),i("br"),i("br"),i("code",null,"VarPointsTo(ai, t)"),i("br"),i("br"),i("code",null,"Taint(j, t).")])])])],-1),i("h2",{id:"_10-5-基于datalog的程序分析的优缺点",tabindex:"-1"},[l("10.5 基于Datalog的程序分析的优缺点 "),i("a",{class:"header-anchor",href:"#_10-5-基于datalog的程序分析的优缺点","aria-label":'Permalink to "10.5 基于Datalog的程序分析的优缺点"'},"​")],-1),i("ul",null,[i("li",null,[i("p",null,"优点："),i("ul",null,[i("li",null,[i("p",null,"简洁易懂；")]),i("li",null,[i("p",null,"容易实现；")]),i("li",null,[i("p",null,"能够受益于现成的 Datalog 引擎的优化")])])]),i("li",null,[i("p",null,"缺点："),i("ul",null,[i("li",null,[i("p",null,"表达能力受限；"),i("ul",null,[i("li",null,"比如说可能无法或者不方便表达某些逻辑。")])]),i("li",null,[i("p",null,"无法完全控制其表现；"),i("ul",null,[i("li",null,"因为这是一个申述式的语言，对于用户来说还是一个黑盒，有些东西是用户不可控的。")])])])])],-1),i("h2",{id:"_10-6-自检问题",tabindex:"-1"},[l("10.6 自检问题 "),i("a",{class:"header-anchor",href:"#_10-6-自检问题","aria-label":'Permalink to "10.6 自检问题"'},"​")],-1),i("ol",null,[i("li",null,[i("p",null,"Datalog 语言的基本语法和语义是什么？")]),i("li",null,[i("p",null,"如何用 Datalog 来实现指针分析？")]),i("li",null,[i("p",null,"如何用 Datalog 来实现污点分析？")])],-1)])),"main-header":s(()=>[a(t.$slots,"main-header")]),"main-header-after":s(()=>[a(t.$slots,"main-header-after")]),"main-nav":s(()=>[a(t.$slots,"main-nav")]),"main-content":s(()=>[a(t.$slots,"main-content")]),"main-content-after":s(()=>[a(t.$slots,"main-content-after")]),"main-nav-before":s(()=>[a(t.$slots,"main-nav-before")]),"main-nav-after":s(()=>[a(t.$slots,"main-nav-after")]),comment:s(()=>[a(t.$slots,"comment")]),footer:s(()=>[a(t.$slots,"footer")]),aside:s(()=>[a(t.$slots,"aside")]),"aside-custom":s(()=>[a(t.$slots,"aside-custom")]),default:s(()=>[a(t.$slots,"default")]),_:3},8,["frontmatter"])}}};export{L as default};
